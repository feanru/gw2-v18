{"version":3,"sources":["../src/index.ts","../src/calculateTreeQuantity.ts","../src/static/currencyDecisionPrices.ts","../src/calculateTreePrices.ts","../src/calculateTreeCraftFlags.ts","../src/cheapestTree.ts","../src/craftingSteps.ts","../src/static/dailyCooldowns.ts","../src/helpers/dailyCooldowns.ts","../src/helpers/recipeItems.ts","../src/helpers/useVendorPrices.ts","../src/updateTree.ts","../src/usedItems.ts","../src/static/vendorItems.ts"],"sourcesContent":["export { cheapestTree } from './cheapestTree'\nexport { craftingSteps } from './craftingSteps'\nexport { dailyCooldowns } from './helpers/dailyCooldowns'\nexport { recipeItems } from './helpers/recipeItems'\nexport { useVendorPrices } from './helpers/useVendorPrices'\nexport { updateTree } from './updateTree'\nexport { usedItems } from './usedItems'\nimport { DAILY_COOLDOWNS } from './static/dailyCooldowns'\nimport { VENDOR_ITEMS } from './static/vendorItems'\n\nexport const staticItems = {\n  dailyCooldowns: DAILY_COOLDOWNS.map((x) => x.id),\n  buyableDailyCooldowns: DAILY_COOLDOWNS.filter((x) => x.tradable).map((x) => x.id),\n  vendorItems: VENDOR_ITEMS,\n}\n","import { RecipeTreeWithCraftFlags, RecipeTree, RecipeTreeWithQuantity } from './types'\n\nexport function calculateTreeQuantity(\n  amount: number,\n  tree: RecipeTreeWithCraftFlags,\n  availableItems?: Record<string, number>\n): RecipeTreeWithCraftFlags\nexport function calculateTreeQuantity(\n  amount: number,\n  tree: RecipeTree,\n  availableItems?: Record<string, number>\n): RecipeTreeWithQuantity\nexport function calculateTreeQuantity(\n  amount: number,\n  tree: RecipeTree | RecipeTreeWithCraftFlags,\n  availableItems: Record<string, number> = {}\n) {\n  // Make sure that we don't modify the passed-in object\n  // We still want to work with a reference in the actual calculation\n  // since the availableItems are a shared state for all sub-recipes\n  return calculateTreeQuantityInner(amount, tree, { ...availableItems })\n}\n\n// Go through a recipe tree and set 'totalQuantity' based on the\n// wanted amount and the output of recipes and sub-recipes\nfunction calculateTreeQuantityInner(\n  amount: number,\n  tree: RecipeTree | RecipeTreeWithCraftFlags,\n  availableItems: Record<string, number>,\n  ignoreAvailable = false,\n  nesting = 0\n): RecipeTreeWithCraftFlags | RecipeTreeWithQuantity {\n  const output = tree.output || 1\n\n  // Calculate the total quantity needed\n  let treeQuantity = amount * tree.quantity\n\n  // Round amount to nearest multiple of the tree output\n  treeQuantity = Math.ceil(treeQuantity / output) * output\n  const totalQuantity = Math.round(treeQuantity)\n\n  // If the item is available and the higher tree is not\n  // bought or already available get as many items of it as possible\n  // (This ignores the root node, because we *always* want to craft all of these)\n  let availableQuantity = 0\n  if (nesting > 0 && tree.type !== 'Currency' && !ignoreAvailable && availableItems[tree.id]) {\n    availableQuantity = Math.min(availableItems[tree.id], totalQuantity)\n    availableItems[tree.id] -= availableQuantity\n  }\n  const usedQuantity = totalQuantity - availableQuantity\n\n  if (!tree.components) {\n    return { ...tree, components: undefined, output, totalQuantity, usedQuantity }\n  }\n\n  // Get the amount of components that need to be crafted\n  // e.g. a recipe outputs 10 and we need 20 -> 2x components\n  const componentAmount = Math.ceil(usedQuantity / output)\n\n  // Ignore available items in components if the tree\n  // doesn't get crafted or is completely available anyway\n  ignoreAvailable =\n    ('craft' in tree && tree.craft === false) || usedQuantity === 0 || ignoreAvailable\n\n  // Adjust the quantity for all tree's subcomponents\n  const components = tree.components.map((component) => {\n    return calculateTreeQuantityInner(\n      componentAmount,\n      component,\n      availableItems,\n      ignoreAvailable,\n      ++nesting\n    )\n  })\n\n  return { ...tree, components, output, totalQuantity, usedQuantity }\n}\n","export const CURRENCY_DECISION_PRICES: Record<number, number | undefined> = {\n  1: 1, // Gold\n  2: 1, // Karma\n  3: 3500, // Laurel\n  4: 3000, // Gem\n  5: 32, // Ascalonian Tear\n  6: 32, // Shard of Zhaitan\n  7: 80, // Fractal Relic\n  9: 32, // Seal of Beetletun\n  10: 32, // Manifesto of the Moletariate\n  11: 32, // Deadly Bloom\n  12: 32, // Symbol of Koda\n  13: 32, // Flame Legion Charr Carving\n  14: 32, // Knowledge Crystal\n  15: 23, // Badge of Honor\n  16: 3600, // Guild Commendation\n  18: undefined, // Transmutation Charge\n  19: 70, // Airship Part\n  20: 70, // Ley Line Crystal\n  22: 70, // Lump of Aurillium\n  23: 3600, // Spirit Shard\n  24: 15 * 80, // Pristine Fractal Relic\n  25: 100, // Geode\n  26: 800, // WvW Skirmish Claim Ticket\n  27: 45, // Bandit Crest\n  28: 3600, // Magnetite Shard\n  29: 3600, // Provisioner Token\n  30: undefined, // PvP League Ticket\n  31: 50, // Proof of Heroics\n  32: 25, // Unbound Magic\n  33: 1600, // Ascended Shards of Glory\n  34: 9, // Trade Contract\n  35: 720, // Elegy Mosaic\n  36: 135, // Testimony of Desert Heroics\n  37: undefined, // Exalted Key\n  38: undefined, // Machete\n  39: 3600, // Gaeting Crystal\n  40: undefined, // Bandit Skeleton Key\n  41: undefined, // Pact Crowbar\n  42: undefined, // Vial of Chak Acid\n  43: undefined, // Zephyrite Lockpick\n  44: undefined, // Trader's Key\n  45: 50, // Volatile Magic\n  46: undefined, // PvP Tournament Voucher\n  47: undefined, // Racing Medallion\n  49: undefined, // Mistborn Key\n  50: 25, // Festival Token\n  51: undefined, // Cache Key\n  52: undefined, // Red Prophet Shard\n  53: 3500, // Green Prophet Shard\n  54: undefined, // Blue Prophet Crystal\n  55: undefined, // Green Prophet Crystal\n  56: undefined, // Red Prophet Crystal\n  57: 300, // Blue Prophet Shard\n  58: undefined, // War Supplies\n  59: undefined, // Unstable Fractal Essence\n  60: 310, // Tyrian Defense Seal\n  61: 200, // Research Note\n  62: 100, // Unusual Coin\n  64: 35, // Jade Sliver\n  65: 135, // Testimony of Jade Heroics\n  67: 35, // Canach Coins\n  68: 320, // Imperial Favor\n  69: 32, // Tales of Dungeon Delving\n  70: undefined, // Legendary Insight\n}\n","import { RecipeTreeWithCraftFlags, RecipeTreeWithPrices, RecipeTreeWithQuantity } from './types'\nimport { CURRENCY_DECISION_PRICES } from './static/currencyDecisionPrices'\n\n// Update the tree prices\nexport function calculateTreePrices(\n  tree: RecipeTreeWithCraftFlags,\n  itemPrices: Record<string, number>\n): RecipeTreeWithCraftFlags\nexport function calculateTreePrices(\n  tree: RecipeTreeWithQuantity,\n  itemPrices: Record<string, number>\n): RecipeTreeWithPrices\nexport function calculateTreePrices(\n  tree: RecipeTreeWithQuantity | RecipeTreeWithCraftFlags,\n  itemPrices: Record<string, number>\n): RecipeTreeWithPrices | RecipeTreeWithCraftFlags {\n  // Calculate the buy prices\n  let buyPriceEach = itemPrices[tree.id] || false\n  if (tree.type === 'Currency') {\n    // Coin is 1c per used quantity, the other currencies do not have a TP price\n    buyPriceEach = tree.id === 1 ? 1 : false\n  }\n  const buyPrice = buyPriceEach ? tree.usedQuantity * buyPriceEach : false\n  let craftResultPrice = buyPrice\n\n  // Calculate the base decision price (may be overwritten later with the craft price)\n  let decisionPriceEach = buyPriceEach || undefined\n  if (tree.type === 'Currency') {\n    decisionPriceEach = CURRENCY_DECISION_PRICES[tree.id]\n  }\n  let decisionPrice = decisionPriceEach ? tree.usedQuantity * decisionPriceEach : false\n\n  if (!tree.components) {\n    return {\n      ...tree,\n      components: undefined,\n      buyPriceEach,\n      buyPrice,\n      decisionPrice,\n      craftResultPrice,\n      craftDecisionPrice: decisionPrice,\n    }\n  }\n\n  // Calculate the tree prices traversal for the sub-components\n  const components = tree.components.map((component) => calculateTreePrices(component, itemPrices))\n\n  // Calculate the craft price out of the best prices\n  const craftDecisionPrice = components.map((c) => c.decisionPrice || 0).reduce((a, b) => a + b, 0)\n  const craftPrice = components.map((c) => c.craftResultPrice || 0).reduce((a, b) => a + b, 0)\n\n  // Update the decision price of this tree segment to the craft price,\n  // used to determine the craft price of the higher-up recipe\n  if (\n    !('craft' in tree && tree.craft === false) &&\n    (('craft' in tree && tree.craft === true) ||\n      !decisionPrice ||\n      craftDecisionPrice < decisionPrice)\n  ) {\n    decisionPrice = craftDecisionPrice\n    craftResultPrice = craftPrice\n  }\n\n  craftResultPrice = craftResultPrice || craftPrice\n  decisionPrice = decisionPrice || craftDecisionPrice\n\n  return {\n    ...tree,\n    components,\n    buyPriceEach,\n    buyPrice,\n    craftPrice,\n    decisionPrice,\n    craftResultPrice,\n    craftDecisionPrice,\n  }\n}\n","import { RecipeTreeWithCraftFlags, RecipeTreeWithPrices } from './types'\n\n// Set the craft flags based on the cheapest price\nexport function calculateTreeCraftFlags(\n  tree: RecipeTreeWithPrices,\n  forceBuyItems: Array<number>\n): RecipeTreeWithCraftFlags {\n  // Craft the item if it can't be bought or it is cheaper to craft\n  const hasComponents = !!tree.components\n  const isUsed = tree.usedQuantity !== 0\n  const isCheaperToCraft =\n    typeof tree.craftPrice !== 'undefined' && (!tree.buyPrice || tree.decisionPrice < tree.buyPrice)\n  const isForceBuy = forceBuyItems.indexOf(tree.id) !== -1\n\n  const craft = hasComponents && isUsed && isCheaperToCraft && !isForceBuy\n\n  if (!tree.components) {\n    return { ...tree, components: undefined, craft }\n  }\n\n  // Adjust the flags for all tree's sub-recipes\n  const components = tree.components.map((component) =>\n    calculateTreeCraftFlags(component, forceBuyItems)\n  )\n\n  return { ...tree, components, craft }\n}\n","import { calculateTreeQuantity } from './calculateTreeQuantity'\nimport { calculateTreePrices } from './calculateTreePrices'\nimport { calculateTreeCraftFlags } from './calculateTreeCraftFlags'\nimport { RecipeTree, RecipeTreeWithCraftFlags, RecipeTreeWithPrices } from './types'\nimport {\n  NestedRecipe,\n  BasicCurrencyComponent,\n  BasicItemComponent,\n} from 'recipe-nesting'\n\nexport function cheapestTree(\n  amount: number,\n  tree: NestedRecipe,\n  itemPrices: Record<string, number>,\n  availableItems: Record<string, number> = {},\n  forceBuyItems: Array<number> = [],\n  valueOwnItems = false,\n  userEfficiencyTiers: Record<string, string> = {\n    '102306': '0',\n    '102205': '0',\n    '103049': '0',\n  }\n): RecipeTreeWithCraftFlags {\n  tree = applyEfficiencyTiersToTree(tree, userEfficiencyTiers)\n  if (valueOwnItems) {\n    const treeWithQuantityWithoutAvailableItems = calculateTreeQuantity(\n      amount,\n      tree as RecipeTree,\n      {}\n    )\n    const treeWithPriceWithoutAvailableItems = calculateTreePrices(\n      treeWithQuantityWithoutAvailableItems,\n      itemPrices\n    )\n\n    const cheaperToBuyItemIds = getCheaperToBuyItemIds(treeWithPriceWithoutAvailableItems)\n\n    // calculateTreeQuantity already checks for craft flags, so we can set them here\n    tree = disableCraftForItemIds(tree, cheaperToBuyItemIds) as NestedRecipe\n  }\n\n  // Adjust the tree total and used quantities\n  const treeWithQuantity = calculateTreeQuantity(amount, tree as RecipeTree, availableItems)\n\n  // Set the initial craft flags based on the subtree prices\n  const treeWithPrices = calculateTreePrices(treeWithQuantity, itemPrices)\n  let treeWithCraftFlags = calculateTreeCraftFlags(treeWithPrices, forceBuyItems)\n\n  // Force the root to be crafted\n  treeWithCraftFlags = { ...treeWithCraftFlags, craft: true }\n\n  // After the \"craft\" flags are set, update the used materials\n  // to only be used for things that actually get crafted\n  const treeWithQuantityPostFlags = calculateTreeQuantity(\n    amount,\n    treeWithCraftFlags,\n    availableItems\n  )\n\n  // Recalculate the correct tree price\n  return calculateTreePrices(treeWithQuantityPostFlags, itemPrices)\n}\n\nfunction getCheaperToBuyItemIds(\n  tree: RecipeTreeWithPrices,\n  ids: Array<number> = []\n): Array<number> {\n  // If buying the item costs less than the possible profit made by selling its craft components (with TP tax), we should buy instead of crafting\n  if (\n    typeof tree.craftDecisionPrice === 'number' &&\n    typeof tree.buyPrice === 'number' &&\n    tree.buyPrice < tree.craftDecisionPrice * 0.85\n  ) {\n    if (!ids.includes(tree.id)) {\n      ids.push(tree.id)\n    }\n  }\n\n  if (tree.components && Array.isArray(tree.components)) {\n    tree.components.forEach((component) => getCheaperToBuyItemIds(component, ids))\n  }\n\n  return ids\n}\n\ntype NestedRecipeAndBasicComponentWithCraftFlag = (\n  | NestedRecipe\n  | BasicItemComponent\n  | BasicCurrencyComponent\n) & {\n  craft?: boolean\n}\n\nfunction disableCraftForItemIds(\n  tree: NestedRecipeAndBasicComponentWithCraftFlag,\n  ids: Array<number>\n) {\n  if (ids.includes(tree.id)) {\n    tree = { ...tree, craft: false }\n  }\n\n  if ('components' in tree && Array.isArray(tree.components)) {\n    tree.components = tree.components.map((component) =>\n      disableCraftForItemIds(component as NestedRecipeAndBasicComponentWithCraftFlag, ids)\n    )\n  }\n\n  return tree\n}\n\nfunction applyEfficiencyTiersToTree(\n  tree: Omit<NestedRecipe, 'id'> & { id: number | null }, // FIXME Not sure why this can be null\n  userEfficiencyTiers: Record<string, string>\n): NestedRecipe {\n  const id = tree.id ? tree.id.toString() : ''\n\n  if (\n    ['102306', '102205', '103049'].includes(id) &&\n    tree.merchant &&\n    tree.merchant.name.includes('Homestead Refinement')\n  ) {\n    const efficiencyTier = Number(userEfficiencyTiers[id])\n\n    if (efficiencyTier > 0) {\n      const component = { ...tree.components[0] }\n\n      // Each efficiency tier lowers input by 50%, if it drops below one then doubles output\n      component.quantity = component.quantity / (efficiencyTier * 2)\n\n      // Bug: Onions are discounted by 75% with first tier\n      if (component.id === 12142) {\n        component.quantity = efficiencyTier === 1 ? 1 : 0.5\n      }\n\n      // Bug: Potatoes are not discounted with first tier\n      if (component.id === 12135) {\n        component.quantity = efficiencyTier === 1 ? 8 : 4\n      }\n\n      let updatedTree = { ...tree, output: component.quantity < 1 ? tree.output * 2 : tree.output }\n\n      // Bug: Iron ore output also halves with second tier\n      if (component.id === 19699 && efficiencyTier === 2) {\n        updatedTree.output = updatedTree.output / 2\n      }\n\n      component.quantity = component.quantity < 1 ? 1 : component.quantity\n      updatedTree = { ...updatedTree, components: [component, ...tree.components.slice(1)] }\n\n      tree = updatedTree\n    }\n  }\n\n  if ('components' in tree && Array.isArray(tree.components)) {\n    tree = {\n      ...tree,\n      components: tree.components.map((component) =>\n        applyEfficiencyTiersToTree(component as NestedRecipe, userEfficiencyTiers)\n      ),\n    }\n  }\n\n  return tree as NestedRecipe\n}\n","import { Prerequisites } from 'recipe-nesting'\nimport { RecipeTreeWithCraftFlags } from './types'\n\nconst MYSTIC_CLOVER_ID = 19675\n\nexport function craftingSteps(tree: RecipeTreeWithCraftFlags) {\n  let steps = craftingStepsInner(tree).reverse()\n\n  // We don't care about steps where we have to craft \"0\" of something\n  // This can happen when a crafting tree is updated after the initial calculation\n  steps = steps.filter((step) => step.quantity > 0)\n\n  // Make sure that \"Mystic Clovers\" (and it's components) get crafted as the first steps,\n  // since they generate items that are always useful for crafting the other steps\n  // Obsidian Shards and Philosopher Stones (required for Mystic Clovers) will be sorted\n  // above the Mystic Clovers in the next step when sorting merchants\n  const mysticCloverSteps = steps.filter((step) => step.id === MYSTIC_CLOVER_ID)\n  steps = steps.filter((step) => step.id !== MYSTIC_CLOVER_ID)\n  steps = [...mysticCloverSteps, ...steps]\n\n  // Move merchants to the top of the steps\n  const merchantSteps = steps\n    .filter(isMerchantWithNoDependencies)\n    .sort((a, b) => a.merchant?.name.localeCompare(b.merchant?.name || '') || 0)\n  steps = steps.filter((step) => !isMerchantWithNoDependencies(step))\n  steps = [...merchantSteps, ...steps]\n\n  return steps.map((step) => ({\n    ...step,\n    // Calculate how many times you actually have to click on \"craft\"\n    // for items with output > 1 (calculate here when all steps are aggregated)\n    crafts: Math.ceil(step.quantity / step.output),\n    output: undefined,\n  }))\n}\n\ninterface CraftingStep {\n  id: number\n  type: 'Item' | 'Recipe' | 'Currency'\n  output: number\n  quantity: number\n  minRating: number | null\n  disciplines: Array<string>\n  merchant?: { name: string; locations: Array<string> }\n  prerequisites: Prerequisites\n  components: Array<{ id: number; type: 'Item' | 'Recipe' | 'Currency'; quantity: number }>\n  hasCraftedComponents: boolean\n}\n\n// Generate an ordered list of crafting steps\nfunction craftingStepsInner(\n  tree: RecipeTreeWithCraftFlags,\n  steps: Array<CraftingStep> = [],\n  index = 0\n) {\n  const treeComponents = tree.components\n\n  // Skip any tree parts where nothing needs to be crafted\n  if (!treeComponents || tree.craft === false || tree.type === 'Currency') {\n    return steps\n  }\n\n  const hasCraftedComponents = treeComponents.some((component) => component.craft)\n\n  // Go through the existing steps, and if we already have a step\n  // with this id, just add up the quantities\n  const stepIndex = steps.findIndex((step) => step.id === tree.id)\n  if (stepIndex !== -1) {\n    steps[stepIndex].quantity += tree.usedQuantity\n    steps[stepIndex].components = steps[stepIndex].components.map((component) => {\n      // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n      const treeComponent = treeComponents.find((x) => x.id === component.id)!\n\n      component.quantity += treeComponent.totalQuantity\n      return component\n    })\n\n    // If *any* of the steps have crafted components, this flag needs to be set\n    if (hasCraftedComponents) {\n      steps[stepIndex].hasCraftedComponents = hasCraftedComponents\n    }\n\n    index = stepIndex\n  }\n\n  // We don't have a step like this yet, push a new one at the given index\n  if (stepIndex === -1) {\n    steps.splice(index, 0, {\n      id: tree.id,\n      type: tree.type,\n      output: tree.output,\n      quantity: tree.usedQuantity,\n      minRating: tree.min_rating,\n      disciplines: tree.disciplines,\n      merchant: tree.merchant,\n      prerequisites: tree.prerequisites,\n      components: treeComponents.map((component) => ({\n        id: component.id,\n        type: component.type,\n        quantity: component.totalQuantity,\n      })),\n      hasCraftedComponents,\n    })\n  }\n\n  // Go through the components and push them after the index of their parent\n  treeComponents.map((component) => craftingStepsInner(component, steps, index + 1))\n  return steps\n}\n\nfunction isMerchantWithNoDependencies(step: CraftingStep): boolean {\n  return (\n    step.disciplines.length === 1 &&\n    step.disciplines[0] === 'Merchant' &&\n    !step.hasCraftedComponents\n  )\n}\n","export const DAILY_COOLDOWNS = [\n  { id: 46745, tradable: false, craftInterval: 'daily' }, // Spool of Thick Elonian Cord\n  { id: 46740, tradable: false, craftInterval: 'daily' }, // Spool of Silk Weaving Thread\n  { id: 46742, tradable: false, craftInterval: 'daily' }, // Lump of Mithrillium\n  { id: 46744, tradable: false, craftInterval: 'daily' }, // Glob of Elder Spirit Residue\n  { id: 43772, tradable: false, craftInterval: 'daily' }, // Charged Quartz Crystal\n  { id: 46738, tradable: true }, // Deldrimor Steel Ingot\n  { id: 80714, tradable: true }, // Carbonized Mithrillium Ingot\n  { id: 46736, tradable: true }, // Spiritwood Plank\n  { id: 80791, tradable: true }, // Composite Wood Board\n  { id: 46739, tradable: true }, // Elonian Leather Square\n  { id: 80723, tradable: true }, // Blended Leather Sheet\n  { id: 46741, tradable: true }, // Bolt of Damask\n  { id: 80775, tradable: true }, // Square of Vabbian Silk\n  { id: 79763, tradable: true }, // Gossamer Stuffing\n  { id: 66913, tradable: true, craftInterval: 'daily' }, // Clay Pot\n  { id: 66993, tradable: true, craftInterval: 'daily' }, // Grow Lamp\n  { id: 66917, tradable: true, craftInterval: 'daily' }, // Plate of Meaty Plant Food\n  { id: 66923, tradable: true, craftInterval: 'daily' }, // Plate of Piquant Plant Food\n  { id: 67377, tradable: true, craftInterval: 'daily' }, // Vial of Maize Balm\n  { id: 67015, tradable: true, craftInterval: 'daily' }, // Heat Stone\n  { id: 91701, tradable: true, craftInterval: 'daily' }, // Cultivated Sesame Seed\n  { id: 91715, tradable: true, craftInterval: 'daily' }, // Cultivated Cilantro Leaf\n  { id: 91793, tradable: true, craftInterval: 'daily' }, // Cultivated Mint Leaf\n  { id: 91796, tradable: true, craftInterval: 'daily' }, // Cultivated Clove\n  { id: 91869, tradable: true, craftInterval: 'daily' }, // Cultivated Peppercorn\n]\n","import { DAILY_COOLDOWNS } from '../static/dailyCooldowns'\nimport { RecipeTreeWithCraftFlags } from '../types'\n\nconst dailyCooldownIds = DAILY_COOLDOWNS.filter((x) => x.craftInterval === 'daily').map((x) => x.id)\n\nexport type DailyCooldownsBreakdown = Record<string, number>\n\n// Get a list of daily cooldowns used in the recipe\nexport function dailyCooldowns(\n  tree: RecipeTreeWithCraftFlags,\n  breakdown: DailyCooldownsBreakdown = {}\n) {\n  if (!tree.components || tree.craft === false || tree.type === 'Currency') {\n    return breakdown\n  }\n\n  if (dailyCooldownIds.indexOf(tree.id) !== -1) {\n    breakdown[tree.id] = (breakdown[tree.id] || 0) + tree.usedQuantity\n  }\n\n  const dailyCap = tree.daily_purchase_cap ? tree.daily_purchase_cap : 0\n  const weeklyCap = tree.weekly_purchase_cap ? tree.weekly_purchase_cap : 0\n  if (dailyCap + weeklyCap > 0) {\n    breakdown[tree.id] = (breakdown[tree.id] || 0) + tree.usedQuantity\n  }\n\n  tree.components.map((component) => dailyCooldowns(component, breakdown))\n  return breakdown\n}\n","import { RecipeTreeWithCraftFlags } from '../types'\n\n// Find all unique item ids used in a recipe tree\nexport function recipeItems(tree: RecipeTreeWithCraftFlags) {\n  if (tree.type === 'Currency') {\n    return []\n  }\n\n  let ids = [tree.id]\n\n  if (!tree.components) {\n    return ids\n  }\n\n  tree.components.map((component) => {\n    ids = ids.concat(recipeItems(component))\n  })\n\n  ids = ids.filter((value, index, self) => self.indexOf(value) === index)\n\n  return ids\n}\n","// (Legacy) Return the price map as-is\nexport function useVendorPrices(priceMap: Record<string, number>): Record<string, number> {\n  return priceMap\n}\n","import { calculateTreeQuantity } from './calculateTreeQuantity'\nimport { calculateTreePrices } from './calculateTreePrices'\nimport { RecipeTreeWithCraftFlags } from './types'\n\n// Cache for already processed subtrees. The key encodes the node id and\n// parameters that influence the calculation (amount, prices and available\n// quantities). If the prices or requested quantity changes, a new cache key is\n// generated and the previous entry is ignored.\nconst treeCache = new Map<string, RecipeTreeWithCraftFlags>()\n\nfunction cacheKey(\n  nodeId: number,\n  amount: number,\n  itemPrices: Record<string, number>,\n  availableItems: Record<string, number>,\n) {\n  const pricesKey = Object.keys(itemPrices)\n    .sort()\n    .map((id) => `${id}:${itemPrices[id]}`)\n    .join('|')\n\n  const availableKey = Object.keys(availableItems)\n    .sort()\n    .map((id) => `${id}:${availableItems[id]}`)\n    .join('|')\n\n  return `${nodeId}|${amount}|${pricesKey}|${availableKey}`\n}\n\nexport function updateTree(\n  amount: number,\n  tree: RecipeTreeWithCraftFlags,\n  itemPrices: Record<string, number>,\n  availableItems: Record<string, number> = {}\n) {\n  const key = cacheKey(tree.id, amount, itemPrices, availableItems)\n  const cachedTree = treeCache.get(key)\n  if (cachedTree) {\n    return cachedTree\n  }\n\n  // Update the tree total and used quantities\n  const treeWithQuantity = calculateTreeQuantity(amount, tree, availableItems)\n\n  // Recalculate the correct tree price\n  const pricedTree = calculateTreePrices(treeWithQuantity, itemPrices)\n  treeCache.set(key, pricedTree)\n  return pricedTree\n}\n","import { RecipeTreeWithCraftFlags } from './types'\n\nexport interface UsedItemsBreakdown {\n  buy: Record<string, number>\n  available: Record<string, number>\n  currency: Record<string, number>\n}\n\n// Generate a list of items to buy and used available items\nexport function usedItems(\n  tree: RecipeTreeWithCraftFlags,\n  breakdown: UsedItemsBreakdown = {\n    buy: {},\n    available: {},\n    currency: {},\n  }\n) {\n  // Add up the used available items\n  const available = tree.totalQuantity - tree.usedQuantity\n  if (available > 0) {\n    breakdown.available[tree.id] = (breakdown.available[tree.id] || 0) + available\n  }\n\n  // This tree part is not getting crafted -> add up the bought items\n  if (!tree.components || tree.craft === false) {\n    if (tree.usedQuantity > 0) {\n      if (tree.type === 'Currency') {\n        breakdown.currency[tree.id] = (breakdown.currency[tree.id] || 0) + tree.usedQuantity\n      } else {\n        breakdown.buy[tree.id] = (breakdown.buy[tree.id] || 0) + tree.usedQuantity\n      }\n    }\n\n    return breakdown\n  }\n\n  // This tree part is getting crafted -> get used items from components\n  tree.components.map((component) => usedItems(component, breakdown))\n  return breakdown\n}\n","// (Legacy) This is no longer used, we now manage vendor items via custom recipes:\n// https://github.com/gw2efficiency/custom-recipes/blob/schema-update/merchants.js\nexport const VENDOR_ITEMS = {}\n"],"mappings":"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","names":[]}