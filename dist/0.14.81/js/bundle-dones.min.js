import{b as t}from"./utils.min.js";import"./config.min.js";import"./services.min.js";!function(){const e=new Map,n=new Map,o={19676:1e4},s=[19675,19925,20796,19665,19674,19626,19672,19673,19645,19650,19655,19639,19635,19621,19633,19634,19641,19642,19628,20799],i=function(t){if(!t)return!1;const e=t.toLowerCase();return e.startsWith("don de ")||e.startsWith("don del ")||e.startsWith("don de la ")},a=function(t){return s.includes(t)},r=async function(n){if(e.has(n))return e.get(n);const o=sessionStorage.getItem("item:"+n);if(o){const t=JSON.parse(o);return e.set(n,t),t}const s=await t("https://api.guildwars2.com/v2/items/"+n);if(!s.ok)throw new Error("No se pudo obtener info de item "+n);const i=await s.json();e.set(n,i);try{sessionStorage.setItem("item:"+n,JSON.stringify(i))}catch(t){}return i},c=async function(e){if(void 0!==o[e]){const t=o[e];return{buys:{unit_price:t},sells:{unit_price:t}}}if(a(e))return null;if(n.has(e))return n.get(e);const s=sessionStorage.getItem("price:"+e);if(s){const t=JSON.parse(s);return n.set(e,t),t}const i=await t("https://api.guildwars2.com/v2/commerce/prices/"+e);if(!i.ok)return null;const r=await i.json();n.set(e,r);try{sessionStorage.setItem("price:"+e,JSON.stringify(r))}catch(t){}return r};"undefined"!=typeof window&&(window.DonesCore={fetchItemData:r,fetchPriceData:c,isGiftName:i,shouldSkipMarketCheck:a}),document.addEventListener("DOMContentLoaded",async function(){const t=new Set,e=new Map;const n=Array.from(document.querySelectorAll(".tab-button[data-tab]")),o=Array.from(document.querySelectorAll(".tab-content")),s=localStorage.getItem("activeDonTab");if(s){const t=n.find(t=>t.getAttribute("data-tab")===s),e=document.getElementById(s);t&&e&&(n.forEach(e=>{const n=e===t;e.classList.toggle("active",n)}),o.forEach(t=>{const n=t===e;t.classList.toggle("active",n),t.style.display=n?"":"none"}))}const a={"tab-don-suerte":()=>window.DonesPages.loadSpecialDons(),"tab-tributo-mistico":()=>window.DonesPages.loadTributo(),"tab-tributo-draconico":()=>window.DonesPages.loadDraconicTribute(),"dones-1ra-gen":()=>window.DonesPages.loadDones1Gen()},l=2e3,u=50;let d=null;const c=async(t=l)=>{if(window.DonesPages)return;if(d)return d;return d=new Promise((e,n)=>{const o=Date.now(),s=()=>{if(window.DonesPages)return e();if(Date.now()-o>=t){const e=new Error("DonesPages not ready");return e.timeoutMs=t,n(e)}setTimeout(s,u)};s()}).finally(()=>{d=null})},r=async n=>{if(!n)return;if(localStorage.setItem("activeDonTab",n),t.has(n))return;if(e.has(n))return e.get(n);const o=(async()=>{try{await c();const o=a[n];if(!o)return;await o(),t.add(n)}catch(t){console.error("Error loading tab content",n,t)}finally{e.delete(n)}})();return e.set(n,o),o};document.addEventListener("tabchange",t=>{const e=t&&t.detail?t.detail.tabId:void 0;e&&r(e)}),await import("./tabs.min.js");let i=(()=>{const t=document.querySelector(".tab-content.active");return t?t.id:null})();if(i)await r(i);else n.length&&n[0].click()})}();
