const e={API_BASE_URL:"/api",CDN_BASE_URL:"",DEFAULT_LANG:"es",FALLBACK_LANGS:["en"],MARKET_CSV_URL:"https://api.datawars2.ie/gw2/v1/items/csv",GW2_API_KEY:"",priceCacheStrategy:"sessionStorage",FEATURE_USE_PRECOMPUTED:!1,FEATURE_MARKET_CSV_EXTERNAL:!0,FEATURE_MARKET_CSV_EXTERNAL_WORKER:!1,FEATURE_DONES_AGGREGATE:!1,PRECOMPUTED_CANARY_THRESHOLD:1,FETCH_GUARD_MODE:"enforce",FETCH_GUARD_WHITELIST:[],CONNECT_ALLOWLIST:[],FETCH_GUARD_REPORT_URL:null,FEATURE_ITEM_API_ROLLOUT:!1};function E(e,E=!1){if("boolean"==typeof e)return e;if(null==e)return E;if("number"==typeof e)return Number.isNaN(e)?E:0!==e;const _=String(e).trim().toLowerCase();return _?!!["1","true","yes","on"].includes(_)||!["0","false","no","off"].includes(_)&&E:E}function _(e,_){if(_&&"object"==typeof _){if(Object.prototype.hasOwnProperty.call(_,"API_BASE_URL")&&null!=_.API_BASE_URL&&(e.API_BASE_URL=_.API_BASE_URL),Object.prototype.hasOwnProperty.call(_,"CDN_BASE_URL")&&null!=_.CDN_BASE_URL&&(e.CDN_BASE_URL=_.CDN_BASE_URL),Object.prototype.hasOwnProperty.call(_,"DEFAULT_LANG")&&_.DEFAULT_LANG&&(e.DEFAULT_LANG=_.DEFAULT_LANG),Object.prototype.hasOwnProperty.call(_,"LANG")&&_.LANG&&(e.DEFAULT_LANG=_.LANG),Object.prototype.hasOwnProperty.call(_,"MARKET_CSV_URL")&&_.MARKET_CSV_URL&&(e.MARKET_CSV_URL=_.MARKET_CSV_URL),Object.prototype.hasOwnProperty.call(_,"GW2_API_KEY")&&null!=_.GW2_API_KEY&&(e.GW2_API_KEY=_.GW2_API_KEY),Object.prototype.hasOwnProperty.call(_,"priceCacheStrategy")&&_.priceCacheStrategy?e.priceCacheStrategy=_.priceCacheStrategy:Object.prototype.hasOwnProperty.call(_,"PRICE_CACHE_STRATEGY")&&_.PRICE_CACHE_STRATEGY&&(e.priceCacheStrategy=_.PRICE_CACHE_STRATEGY),Object.prototype.hasOwnProperty.call(_,"FEATURE_USE_PRECOMPUTED")&&(e.FEATURE_USE_PRECOMPUTED=_.FEATURE_USE_PRECOMPUTED),Object.prototype.hasOwnProperty.call(_,"FEATURE_MARKET_CSV_EXTERNAL")?e.FEATURE_MARKET_CSV_EXTERNAL=_.FEATURE_MARKET_CSV_EXTERNAL:Object.prototype.hasOwnProperty.call(_,"FEATURE_MARKET_CSV_INTERNAL")&&(e.FEATURE_MARKET_CSV_EXTERNAL=!E(_.FEATURE_MARKET_CSV_INTERNAL,!0)),Object.prototype.hasOwnProperty.call(_,"FEATURE_MARKET_CSV_EXTERNAL_WORKER")&&(e.FEATURE_MARKET_CSV_EXTERNAL_WORKER=_.FEATURE_MARKET_CSV_EXTERNAL_WORKER),Object.prototype.hasOwnProperty.call(_,"FEATURE_DONES_AGGREGATE")&&(e.FEATURE_DONES_AGGREGATE=_.FEATURE_DONES_AGGREGATE),Object.prototype.hasOwnProperty.call(_,"FEATURE_ITEM_API_ROLLOUT")&&(e.FEATURE_ITEM_API_ROLLOUT=_.FEATURE_ITEM_API_ROLLOUT),Object.prototype.hasOwnProperty.call(_,"PRECOMPUTED_CANARY_THRESHOLD")&&(e.PRECOMPUTED_CANARY_THRESHOLD=_.PRECOMPUTED_CANARY_THRESHOLD),Object.prototype.hasOwnProperty.call(_,"FETCH_GUARD_MODE")&&"string"==typeof _.FETCH_GUARD_MODE&&(e.FETCH_GUARD_MODE=_.FETCH_GUARD_MODE),Object.prototype.hasOwnProperty.call(_,"FETCH_GUARD_WHITELIST")){const E=_.FETCH_GUARD_WHITELIST;if(Array.isArray(E))e.FETCH_GUARD_WHITELIST=[...E];else if("string"==typeof E){const _=E.split(",").map(e=>e.trim()).filter(Boolean);e.FETCH_GUARD_WHITELIST=_}}if(Object.prototype.hasOwnProperty.call(_,"CONNECT_ALLOWLIST")&&Array.isArray(_.CONNECT_ALLOWLIST)&&(e.CONNECT_ALLOWLIST=[..._.CONNECT_ALLOWLIST]),Object.prototype.hasOwnProperty.call(_,"FALLBACK_LANGS")){const E=_.FALLBACK_LANGS;Array.isArray(E)?e.FALLBACK_LANGS=[...E]:"string"==typeof E&&(e.FALLBACK_LANGS=E.split(",").map(e=>e.trim()).filter(Boolean))}else if(Object.prototype.hasOwnProperty.call(_,"FALLBACK_LANG")){const E=_.FALLBACK_LANG;"string"==typeof E&&(e.FALLBACK_LANGS=E.split(",").map(e=>e.trim()).filter(Boolean))}if(Object.prototype.hasOwnProperty.call(_,"FETCH_GUARD_REPORT_URL")){const E=_.FETCH_GUARD_REPORT_URL;null!=E&&"string"!=typeof E||(e.FETCH_GUARD_REPORT_URL=E)}}}function t(){const t={...e,FETCH_GUARD_WHITELIST:[...e.FETCH_GUARD_WHITELIST],CONNECT_ALLOWLIST:[...e.CONNECT_ALLOWLIST]},A=("undefined"!=typeof globalThis?globalThis.window&&"object"==typeof globalThis.window?globalThis.window:globalThis.self&&"object"==typeof globalThis.self?globalThis.self:globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0)||("undefined"!=typeof globalThis?globalThis:void 0),o=A&&"object"==typeof A.Config?A.Config:null,r=A&&"object"==typeof A.__RUNTIME_CONFIG__?A.__RUNTIME_CONFIG__:null,n=A&&"object"==typeof A.__SECURE_RUNTIME_CONFIG__?A.__SECURE_RUNTIME_CONFIG__:null,R=function({legacy:e,runtime:_,secureRuntime:t,globalScope:A}){const o=[t&&(t.DEBUG_RUNTIME??t.DEBUG),_&&(_.DEBUG_RUNTIME??_.DEBUG),e&&(e.DEBUG_RUNTIME??e.DEBUG),A&&(A.__RUNTIME_DEBUG__??A.__DEBUG__)];for(const e of o)if(void 0!==e)return E(e,!1);if(A&&A.location&&"string"==typeof A.location.search){const e=String(A.location.search||"");if(e)try{const _=new URLSearchParams(e.startsWith("?")?e.slice(1):e),t=["debugRuntime","runtimeDebug","debug-config"];for(const e of t)if(_.has(e)){const t=_.get(e);return E(null==t||t,!0)}}catch(E){if(/[?&](debugRuntime|runtimeDebug|debug-config)(?:=|&|$)/i.test(e))return!0}}return!1}({legacy:o,runtime:r,secureRuntime:n,globalScope:A});_(t,o),_(t,r),_(t,n),t.FEATURE_USE_PRECOMPUTED=E(t.FEATURE_USE_PRECOMPUTED,e.FEATURE_USE_PRECOMPUTED),t.FEATURE_MARKET_CSV_EXTERNAL=E(t.FEATURE_MARKET_CSV_EXTERNAL,e.FEATURE_MARKET_CSV_EXTERNAL),t.FEATURE_MARKET_CSV_EXTERNAL_WORKER=E(t.FEATURE_MARKET_CSV_EXTERNAL_WORKER,e.FEATURE_MARKET_CSV_EXTERNAL_WORKER),t.FEATURE_ITEM_API_ROLLOUT=E(t.FEATURE_ITEM_API_ROLLOUT,e.FEATURE_ITEM_API_ROLLOUT);const T=Number(t.PRECOMPUTED_CANARY_THRESHOLD);t.PRECOMPUTED_CANARY_THRESHOLD=Number.isFinite(T)?Math.min(Math.max(T,0),100):e.PRECOMPUTED_CANARY_THRESHOLD;const i=Array.isArray(t.FALLBACK_LANGS)?t.FALLBACK_LANGS:"string"==typeof t.FALLBACK_LANGS?t.FALLBACK_LANGS.split(","):[];if(null!=t.CDN_BASE_URL&&""!==t.CDN_BASE_URL){const e=String(t.CDN_BASE_URL).trim().replace(/\/$/,"");t.CDN_BASE_URL=e}else t.CDN_BASE_URL="";const L=String(t.DEFAULT_LANG||e.DEFAULT_LANG).trim().toLowerCase();t.FALLBACK_LANGS=[...new Set(i.map(e=>"string"==typeof e?e.trim().toLowerCase():"").filter(e=>e&&e!==L))],t.LANG=t.DEFAULT_LANG||e.DEFAULT_LANG;const a=String(t.LANG||"").trim().toLowerCase();return t.FALLBACK_LANGS=t.FALLBACK_LANGS.filter(e=>e&&e!==a),function({debugMode:e,legacy:E,runtime:_,secureRuntime:t}){if(!e||"undefined"==typeof console||null===console)return;const A=new Date,o={legacyConfig:Boolean(E),runtimeConfig:Boolean(_),secureRuntimeConfig:Boolean(t),runtimeLoadedAt:_&&Object.prototype.hasOwnProperty.call(_,"__loadedAt")?_.__loadedAt:null,configInitializedAt:A.toISOString()};if(!_)return void console.warn("[runtime-config][debug] runtime-env.js was not available during config initialization.",o);if(!Object.prototype.hasOwnProperty.call(_,"__loadedAt"))return void console.warn('[runtime-config][debug] runtime-env.js missing "__loadedAt" marker; verify load order.',o);const r="string"==typeof _.__loadedAt?Date.parse(_.__loadedAt):Number.isFinite(_.__loadedAt)?Number(_.__loadedAt):Number.NaN;if(Number.isNaN(r))return void console.warn('[runtime-config][debug] runtime-env.js has an invalid "__loadedAt" timestamp.',o);const n=A.getTime()-r;o.runtimeLoadedDeltaMs=n,n<-50?console.warn("[runtime-config][debug] runtime-env.js appears to have executed after config.js. Ensure /runtime-env.js loads first.",o):console.info("[runtime-config][debug] runtime configuration applied successfully.",{...o,lang:_.LANG,flags:_.FLAGS})}({debugMode:R,legacy:o,runtime:r,secureRuntime:n}),t}export{t as g};
