import{b as t}from"./utils.min.js";import"./config.min.js";import"./services.min.js";!function(){const e=new Map,n=new Map,o={19676:1e4},s=[19675,19925,20796,19665,19674,19626,19672,19673,19645,19650,19655,19639,19635,19621,19633,19634,19641,19642,19628,20799],i=function(t){if(!t)return!1;const e=t.toLowerCase();return e.startsWith("don de ")||e.startsWith("don del ")||e.startsWith("don de la ")},a=function(t){return s.includes(t)},r=async function(n){if(e.has(n))return e.get(n);const o=sessionStorage.getItem("item:"+n);if(o){const t=JSON.parse(o);return e.set(n,t),t}const s=await t("https://api.guildwars2.com/v2/items/"+n);if(!s.ok)throw new Error("No se pudo obtener info de item "+n);const i=await s.json();e.set(n,i);try{sessionStorage.setItem("item:"+n,JSON.stringify(i))}catch(t){}return i},c=async function(e){if(void 0!==o[e]){const t=o[e];return{buys:{unit_price:t},sells:{unit_price:t}}}if(a(e))return null;if(n.has(e))return n.get(e);const s=sessionStorage.getItem("price:"+e);if(s){const t=JSON.parse(s);return n.set(e,t),t}const i=await t("https://api.guildwars2.com/v2/commerce/prices/"+e);if(!i.ok)return null;const r=await i.json();n.set(e,r);try{sessionStorage.setItem("price:"+e,JSON.stringify(r))}catch(t){}return r};"undefined"!=typeof window&&(window.DonesCore={fetchItemData:r,fetchPriceData:c,isGiftName:i,shouldSkipMarketCheck:a}),document.addEventListener("DOMContentLoaded",async function(){const t=new Set,e=new Set,n=Array.from(document.querySelectorAll(".tab-button[data-tab]")),o=Array.from(document.querySelectorAll(".tab-content")),a=localStorage.getItem("activeDonTab");if(a){const r=n.find(t=>t.getAttribute("data-tab")===a),l=document.getElementById(a);r&&l&&(n.forEach(t=>{const e=t===r;t.classList.toggle("active",e)}),o.forEach(t=>{const e=t===l;t.classList.toggle("active",e),t.style.display=e?"":"none"}))}const c=()=>window.DonesPages?Promise.resolve():new Promise(t=>{const e=()=>{document.removeEventListener("donespages:ready",e),t()};document.addEventListener("donespages:ready",e,{once:!0})}),i=import("./tabs.min.js"),s=c(),d=Promise.all([i,s]),u={"tab-don-suerte":()=>window.DonesPages?.loadSpecialDons(),"tab-tributo-mistico":()=>window.DonesPages?.loadTributo(),"tab-tributo-draconico":()=>window.DonesPages?.loadDraconicTribute(),"dones-1ra-gen":()=>window.DonesPages?.loadDones1Gen()};async function f(n2){if(!n2)return;if(localStorage.setItem("activeDonTab",n2),t.has(n2)||e.has(n2))return;const o2=u[n2];if(o2){e.add(n2);try{await d;const t3=o2();await t3,t.add(n2)}finally{e.delete(n2)}}}document.addEventListener("tabchange",t=>{f(t&&t.detail?t.detail.tabId:void 0)}),await i;const m=document.querySelector(".tab-content.active");m?f(m.id):n.length&&n[0].click()}})}();
