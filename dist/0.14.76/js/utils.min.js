import{getItemBundles as e}from"./services.min.js";import{g as t}from"./config.min.js";const n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:null,r="__GW2_FETCH_GUARD_INSTALLED__";if(n&&"function"==typeof n.fetch&&!n[r]){const Jt=n.fetch;let Xt=a(n)||"http://localhost";const Vt=()=>{const e=a(n);e&&Xt!==e&&(Xt=e);const r=function(){try{return t()}catch{return null}}(),o=function(e){if("string"!=typeof e)return"off";const t=e.trim().toLowerCase();if(!t)return"off";const n=t.replace(/[_\s]+/g,"-");if(["off","disabled","disable","none","0","false"].includes(n))return"off";if(["enforce","block","blocked","deny","enforced","strict","on","true"].includes(n))return"enforce";if(["report-only","report","monitor","monitoring","warn","warning"].includes(n))return"report-only";return"off"}(r?.FETCH_GUARD_MODE),s=function(e){if("string"!=typeof e)return null;const t=e.trim();return t||null}(r?.FETCH_GUARD_REPORT_URL),l=function(e,t){const n=new Set,r=e=>{e&&(Array.isArray(e)?e.forEach(r):n.add(e))},a=e=>{if(e||0===e)if(Array.isArray(e))e.forEach(a);else if("string"!=typeof e)try{const n=i(String(e),t);r(n)}catch{}else e.split(",").forEach(e=>{const n=i(e.trim(),t);r(n)})},o=[e?.API_BASE_URL,e?.MARKET_CSV_URL,"/api","api","/backend/api","backend/api","/recipe-tree","https://api.guildwars2.com","https://api.datawars2.ie"],s=e?.FETCH_GUARD_WHITELIST,l=function(e){if(Array.isArray(e))return e.length>0;if(null==e)return!1;if("string"==typeof e)return e.split(",").some(e=>e.trim());return!0}(s);a(o),a(s),a(e?.fetchGuardWhitelist),a(e?.fetchWhitelist),a(e?.FETCH_WHITELIST),l||a(e?.CONNECT_ALLOWLIST);return Array.from(n)}(r,e);return{mode:o,reportUrl:s,whitelist:l,locationOrigin:e}},Kt=(e,t,r)=>{if("off"===r.mode)return;const a=`[fetchGuard] ${e}: ${t}`;try{"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(a)}catch{}if(!r.reportUrl)return;let o;try{o=JSON.stringify({source:"fetchGuard",reason:e,targetUrl:t,mode:r.mode,timestamp:Date.now(),locationOrigin:r.locationOrigin})}catch{o=null}if(o){try{if("function"==typeof n.navigator?.sendBeacon)return void n.navigator.sendBeacon(r.reportUrl,o)}catch{}try{if("function"==typeof n.Image){const e=encodeURIComponent(o),t=function(e,t,n){if(!e)return null;try{const r=new URL(e,n);return r.searchParams.append("payload",t),r.href}catch{try{const n=e.includes("?")?"&":"?";return`${e}${n}payload=${t}`}catch{return null}}}(r.reportUrl,e,Xt);if(!t)return;const a=new n.Image;try{"referrerPolicy"in a&&(a.referrerPolicy="no-referrer")}catch{}const i=function(e){const t="__FETCH_GUARD_REPORT_IMAGES__";if(!e[t])try{Object.defineProperty(e,t,{value:new Set,configurable:!0,enumerable:!1,writable:!1})}catch{e[t]=new Set}return e[t]}(n);i.add(a);const s=()=>i.delete(a);try{a.onload=s,a.onerror=s}catch{}a.src=t}}catch{}}},Yt=function(e,t){const n=Vt(),r=function(e,t){if(!e&&""!==e)return null;const n=e=>{try{return new URL(e,t)}catch{return null}};if("undefined"!=typeof URL)try{if(e instanceof URL)return e}catch{}if("undefined"!=typeof Request)try{if(e instanceof Request)return n(e.url)}catch{}if("string"==typeof e)return n(e);if(e&&"string"==typeof e.url)return n(e.url);return null}(e,Xt);if(!r||"off"===n.mode||function(e,t){if(!e)return!1;const n="string"==typeof e.hostname?e.hostname.toLowerCase():"",r="string"==typeof e.origin?e.origin:"";let a="";if(r&&"null"!==r)try{a=new URL(r).hostname.toLowerCase()}catch{const e=r.toLowerCase(),t=e.indexOf("://");a=t>=0?e.slice(t+3):e}for(const r of t)switch(r.type){case"wildcard":return!0;case"origin":if(e.origin===r.value)return!0;break;case"href":if(e.href.startsWith(r.value))return!0;break;case"hostname":if(n===r.value)return!0;if(a&&a===r.value)return!0;break;case"hostname-pattern":if(s(n,r.value))return!0;if(s(a,r.value))return!0;break;case"pathname":if(e.pathname.startsWith(r.value))return!0}return!1}(r,n.whitelist))return Jt.call(this,e,t);let a;var o;o=r,a=o?.pathname.includes("/backend/")?"Legacy backend fetch detected":function(e,t){return!!e&&(!!t&&("null"!==e.origin&&e.origin!==t))}(r,n.locationOrigin)?"External fetch detected":"Blocked fetch detected";const i=function(e,t){if(e?.href)return e.href;if("string"==typeof t)return t;if(t&&"string"==typeof t.url)return t.url;return"unknown target"}(r,e);return Kt(a,i,n),"enforce"===n.mode?Promise.reject(function(e,t){const n=new Error(`[fetchGuard] ${e}: ${t}`);return n.name="FetchGuardError",n.reason=e,n.url=t,n}(a,i)):Jt.call(this,e,t)};Yt.originalFetch=Jt,n.fetch=Yt,n[r]=!0}function a(e){if(!e||"object"!=typeof e)return;const t=e.location&&"object"==typeof e.location?e.location:null,n=o(t?.origin);if(n)return n;const r=o(e.origin),a=function(e,t){if("string"!=typeof e)return null;const n=e.trim();if(!n)return null;try{return o(new URL(n).origin)}catch{if(!t)return null;try{return o(new URL(n,t).origin)}catch{return null}}}(t?.href,r);return a||(r||void 0)}function o(e){if("string"!=typeof e)return null;const t=e.trim();return t&&"null"!==t.toLowerCase()?t:null}function i(e,t){if(!e)return null;const n=e.trim();if(!n)return null;const r=n.replace(/^['"]|['"]$/g,"");if(!r)return null;const a=r.toLowerCase();if("self"===a){const e=o(t);return e?{type:"origin",value:e}:{type:"pathname",value:"/recipe-tree"}}if("*"===a)return{type:"wildcard"};if(/^\*\.[^*]+/.test(r)){const e=r.slice(2).toLowerCase();return e?{type:"hostname-pattern",value:e}:null}if(r.startsWith("//"))try{return{type:"origin",value:new URL(r,t||"http:").origin}}catch{return null}if(/^[a-zA-Z]+:\/\//.test(r))try{const e=new URL(r);return r.endsWith("/"),{type:"href",value:e.href}}catch{return null}if(r.startsWith("/"))return{type:"pathname",value:r};if(r.includes("://"))try{return{type:"href",value:new URL(r).href}}catch{return null}return r.includes(".")?{type:"hostname",value:r.toLowerCase()}:{type:"pathname",value:r.startsWith("/")?r:`/${r}`}}function s(e,t){if(!e||!t)return!1;const n=e.toLowerCase(),r=t.toLowerCase().replace(/^\.+/,"");return!!r&&(n===r||n.endsWith(`.${r}`))}const l=[];function c(){const e=Date.now()-6e4;for(;l.length&&l[0]<e;)l.shift()}function u(){c();const e=l.length;return e>5?"down":e>0?"slow":"ok"}let f;function d(){if("undefined"==typeof document)return;const e=u();f||(f=document.createElement("div"),f.id="api-status-indicator",f.style.position="fixed",f.style.bottom="10px",f.style.right="10px",f.style.padding="4px 8px",f.style.background="rgba(0,0,0,0.7)",f.style.color="#fff",f.style.borderRadius="4px",f.style.zIndex="10000",f.style.display="none",document.body.appendChild(f)),"ok"===e?f.style.display="none":(f.textContent="slow"===e?"API lenta":"API caída",f.style.display="block")}var p={recordFailure:function(){l.push(Date.now()),c(),d()},recordSuccess:function(){c(),d()},getState:u,getBackoff:function(){const e=u();return"down"===e?5e3:"slow"===e?1e3:0}};async function g(e,t={}){const{timeout:n=8e3,retries:r=3,backoff:a=300,signal:o,...i}=t;for(let t=0;t<=r;t++){const s=new AbortController,l=setTimeout(()=>s.abort(),n);o&&(o.aborted?s.abort():o.addEventListener("abort",()=>s.abort(),{once:!0}));try{const t=await fetch(e,{...i,signal:s.signal});return clearTimeout(l),p.recordSuccess(),t}catch(e){if(clearTimeout(l),p.recordFailure(),o?.aborted||t===r)throw e;const n=a*Math.pow(2,t);await new Promise(e=>setTimeout(e,n))}}}const h=Object.prototype.hasOwnProperty;function m(e){return null==e?[]:Array.isArray(e)?e:[e]}function y(e){if(null==e)return{data:null,meta:{errors:[]}};if("object"!=typeof e||e instanceof Response)return{data:e,meta:{errors:[]}};if(Array.isArray(e))return{data:e,meta:{errors:[]}};if(h.call(e,"data")){const t=h.call(e,"meta")&&"object"==typeof e.meta?{...e.meta,errors:m(e.meta?.errors)}:{errors:[]};return{data:e.data,meta:t}}if(h.call(e,"meta")){return{data:null,meta:"object"==typeof e.meta?{...e.meta,errors:m(e.meta?.errors)}:{errors:[]}}}const{errors:t,...n}=e;return{data:n,meta:{errors:m(t)}}}var b=Object.freeze({__proto__:null,normalizeApiResponse:y,unwrapApiResponse:function(e){const{data:t}=y(e);return t}});const _={item:null,recipe:null,price:3e5,history:864e5,bundle:3e5},w="undefined"!=typeof window&&"BroadcastChannel"in window?new BroadcastChannel("cache-sync"):null;let S=null;function E(e){w&&w.postMessage({type:"delete",key:e})}const A=new Map;!function(e){S=e,w&&w.addEventListener("message",({data:e})=>{const{type:t,key:n,entry:r}=e||{};if("request-bundles"!==t)t&&n&&("set"===t&&r?S.set(n,r):"delete"===t&&S.delete(n));else{if(!S)return;S.forEach((e,t)=>{t.startsWith("bundle_")&&w.postMessage({type:"set",key:t,entry:e})})}})}(A),w&&w.postMessage({type:"request-bundles"});const v="undefined"!=typeof localStorage;function M(e){try{return JSON.parse(e)}catch{return null}}function T(e,t){if(v)try{localStorage.setItem(e,function({value:e,expiresAt:t,etag:n,lastModified:r,lang:a,source:o,fallback:i}){return JSON.stringify({value:e,expiresAt:t,etag:n,lastModified:r,lang:a,source:o,fallback:i})}(t))}catch{}}function k(e,t,n=void 0,r={}){if(void 0===n){const t=e.split("_")[0];n=_[t]}const a=null==n?null:Date.now()+n,{etag:o=null,lastModified:i=null,lang:s=null,source:l=null,fallback:c=null}=r,u={value:t,expiresAt:a,updatedAt:(new Date).toISOString(),etag:o,lastModified:i,lang:s,source:l,fallback:c};A.set(e,u),T(e,{value:t,expiresAt:a,etag:o,lastModified:i,lang:s,source:l,fallback:c}),function(e,t){w&&w.postMessage({type:"set",key:e,entry:t})}(e,u)}function N(e,t=!1){let n=A.get(e);if(!n){const t=function(e){if(!v)return null;const t=localStorage.getItem(e);if(!t)return null;const n=M(t);return n||(localStorage.removeItem(e),null)}(e);if(t){const{value:r,expiresAt:a=null,etag:o=null,lastModified:i=null,lang:s=null,source:l=null,fallback:c=null}=t;n={value:r,expiresAt:a,updatedAt:(new Date).toISOString(),etag:o,lastModified:i,lang:s,source:l,fallback:c},A.set(e,n)}}return n?n.expiresAt&&Date.now()>n.expiresAt?(A.delete(e),v&&localStorage.removeItem(e),E(e),null):t?n:n.value:null}function I(e){if(!e)return 0;const t=String(e),n=new Set;if(A.forEach((e,r)=>{r.startsWith(t)&&(A.delete(r),n.add(r))}),v){const e=[];for(let r=0;r<localStorage.length;r+=1){const a=localStorage.key(r);a&&a.startsWith(t)&&(e.push(a),n.add(a))}e.forEach(e=>{try{localStorage.removeItem(e)}catch{}})}return n.forEach(e=>E(e)),n.size}!function(){if(!v)return;const e=[];for(let t=0;t<localStorage.length;t++){const n=localStorage.key(t),r=M(localStorage.getItem(n));if(!r)continue;const{expiresAt:a}=r;a&&Date.now()>a&&e.push(n)}e.forEach(e=>{localStorage.removeItem(e),E(e)})}();const C=new Map;function L(e){return C.get(e)?.promise}function O(e,t,n){return C.set(e,{promise:t,controller:n}),t.finally(()=>C.delete(e)),t}function R(e){const t=C.get(e);t?.controller&&t.controller.abort()}function U(e,t={},n=null,r=null,a){const o=C.get(e);o&&o.controller?.abort(),n&&!r&&(r=N(n,!0));const i={...t.headers||{}};r?.etag&&(i["If-None-Match"]=r.etag),r?.lastModified&&(i["If-Modified-Since"]=r.lastModified);const s=a?null:new AbortController,l=a??t.signal??s?.signal;return O(e,g(e,{...t,headers:i,signal:l}).then(async e=>304===e.status&&r?new Response(JSON.stringify(r.value),{status:200,headers:{"X-Cache":"HIT",ETag:r.etag||"","Last-Modified":r.lastModified||""}}):e).catch(e=>{if(e instanceof DOMException&&"AbortError"===e.name)throw e;throw e}),s).then(e=>e.clone())}var j={fetchWithCache:U,getRequest:L,setRequest:(e,t)=>O(e,t,null),abortRequest:R},P=Object.freeze({__proto__:null,abortRequest:R,default:j,fetchWithCache:U,getRequest:L});const $=new Map;function F(){return"sessionStorage"===function(){const e=t();return e?.priceCacheStrategy||"sessionStorage"}()}function D(e){return`price_${e}`}function x(e){if(!F()||"undefined"==typeof sessionStorage)return null;const t=sessionStorage.getItem(D(e));if(!t)return null;try{const{value:n,expires:r}=JSON.parse(t);return r&&Date.now()>r?(sessionStorage.removeItem(D(e)),null):n}catch{return sessionStorage.removeItem(D(e)),null}}async function B(e){if(!Array.isArray(e)||0===e.length)return new Map;const n=t();if("redis"===(n?.priceCacheStrategy||"sessionStorage")){const t=`/backend/api/itemBundle.php?ids=${e.join(",")}`,n=await fetch(t);if(!n.ok)throw new Error("Price fetch failed");const r=await n.json().catch(()=>null),{data:a,meta:o}=y(r),i=Array.isArray(a)?a:[];!Array.isArray(a)&&Array.isArray(o?.errors)&&o.errors.length&&console.warn("itemBundle precios devolvió errores",o.errors);const s=new Map;return i.forEach(e=>{const t=e.market||{};s.set(e.id,{buy_price:t.buy_price||0,sell_price:t.sell_price||0})}),s}{const t=["id","buy_price","sell_price"].join(","),r=Boolean(n?.FEATURE_MARKET_CSV_EXTERNAL)?n?.MARKET_CSV_URL||"https://api.datawars2.ie/gw2/v1/items/csv":function(e,t){const n=("string"==typeof e?e.trim():"").replace(/\/+$/,""),r=String(t).replace(/^\/+/,"");return n?r?`${n}/${r}`:n||"/":r?`/${r}`:"/"}(n?.API_BASE_URL||"/api","/market.csv"),a=new URLSearchParams;a.set("fields",t),a.set("ids",e.join(","));const o=`${r}?${a.toString()}`,i=await fetch(o);if(!i.ok)throw new Error("Price fetch failed");const s=(await i.text()).trim().split("\n"),l=s[0].split(","),c=new Map;for(let e=1;e<s.length;e++){if(!s[e])continue;const t=s[e].split(","),n={};l.forEach((e,r)=>{const a=t[r];n[e]=void 0!==a?isNaN(a)?a:Number(a):null}),null!=n.id&&c.set(n.id,{buy_price:n.buy_price||0,sell_price:n.sell_price||0})}return c}}async function G(e=[]){const t=new Map,n=[];if(e.forEach(e=>{if(e=Number(e),$.has(e))return void t.set(e,$.get(e));const r=x(e);r?($.set(e,r),t.set(e,r)):n.push(e)}),n.length)try{(await B(n)).forEach((e,n)=>{$.set(n,e),function(e,t){if(F()&&"undefined"!=typeof sessionStorage)try{sessionStorage.setItem(D(e),JSON.stringify({value:t,expires:Date.now()+3e5}))}catch{}}(n,e),t.set(n,e)})}catch(e){console.error("Error preloading prices",e)}return e.forEach(e=>{e=Number(e),!t.has(e)&&$.has(e)&&t.set(e,$.get(e)),t.has(e)||t.set(e,{buy_price:0,sell_price:0})}),t}async function W(e){if(e=Number(e),$.has(e))return $.get(e);const t=x(e);if(t)return $.set(e,t),t;return(await G([e])).get(e)}function H(){if($.clear(),F()&&"undefined"!=typeof sessionStorage)for(let e=sessionStorage.length-1;e>=0;e--){const t=sessionStorage.key(e);t&&t.startsWith("price_")&&sessionStorage.removeItem(t)}}var q=Object.freeze({__proto__:null,clearCache:H,getPrice:W,preloadPrices:G});function z(e){if("undefined"==typeof window||!window)return;if(!new Set(["hit","miss","stale"]).has(e))return;const t=window.__cacheMetrics__&&"object"==typeof window.__cacheMetrics__?{hit:Number(window.__cacheMetrics__.hit)||0,miss:Number(window.__cacheMetrics__.miss)||0,stale:Number(window.__cacheMetrics__.stale)||0,lastUpdated:Number(window.__cacheMetrics__.lastUpdated)||0}:{hit:0,miss:0,stale:0,lastUpdated:0};t[e]+=1,t.lastUpdated=Date.now(),window.__cacheMetrics__=t,"function"==typeof window.dispatchEvent&&"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("cache-metrics",{detail:{...t}}))}function Q(e){const t=Number(e);return Number.isFinite(t)?t:e}function J(e){return e?Array.isArray(e)?e.map(e=>String(e||"").trim()).filter(Boolean).join(","):"string"==typeof e?e.split(",").map(e=>e.trim()).filter(Boolean).join(","):null:null}async function X(t,{lang:n,includePagination:r=!1}={}){const a="string"==typeof n&&n.trim()?n.trim():"es",o=t.map(e=>Q(e)).filter(e=>{if(null==e||""===e)return!1;if(Number.isFinite(e))return e>0;const t=String(e).trim();return Boolean(t)});if(0===o.length){const e={source:"fallback",lang:a,stale:!0,errors:[{code:"no_ids",msg:"No item ids provided for legacy aggregate"}]};return r&&(e.pagination={page:1,pageSize:0,totalPages:1,hasNext:!1}),{priceMap:{},iconMap:{},rarityMap:{},itemMap:{},meta:e}}let i;try{i=await e(o)}catch(e){const t=new Error("Legacy aggregate fallback failed");throw t.cause=e,t}const s={},l={},c={},u={},f=[];let d=0;o.forEach((e,t)=>{const n=Q(e),r=Number.isFinite(Number(n))?Number(n):null,a=String(n),o=Array.isArray(i)?i[t]:null;if(!o||"object"!=typeof o)return s[a]={id:r??null,buy_price:null,sell_price:null},l[a]=null,c[a]=null,u[a]=null,void f.push({code:"missing_bundle",msg:`Missing bundle data for ${a}`});const p=function(e){if(!e||"object"!=typeof e)return{buy_price:null,sell_price:null};const t=e=>{const t=Number(e);return Number.isFinite(t)&&t>=0?t:null};return{buy_price:[e.buy_price,e.buyPrice,e.buys?.unit_price,e.buy?.unit_price].map(t).find(e=>null!=e)??null,sell_price:[e.sell_price,e.sellPrice,e.sells?.unit_price,e.sell?.unit_price].map(t).find(e=>null!=e)??null}}(o.market);s[a]={id:r??null,buy_price:p.buy_price,sell_price:p.sell_price};const g=function(e,t){if(!t||"object"!=typeof t)return null;const n=e=>{if(null==e)return null;return String(e).trim()||null},r=e=>{const t=Number(e);return Number.isFinite(t)?t:null};return{id:Number.isFinite(Number(e))?Number(e):r(t.id)??null,name:n(t.name),icon:n(t.icon),type:n(t.type),rarity:n(t.rarity),level:r(t.level)}}(n,o.item);l[a]=g?.icon??null,c[a]=g?.rarity??null,u[a]=g;const h=function(e){const{extra:t}=e&&"object"==typeof e?e:{},n=[t?.last_updated,t?.lastUpdated,t?.lastUpdatedAt];for(const e of n){const t=Number(e);if(!Number.isFinite(t)||t<=0)continue;const n=t>1e12?t:1e3*t;if(Number.isFinite(n)&&n>0)return n}return null}(o);h&&h>d&&(d=h)});const p={source:"fallback",lang:a,stale:!0,warnings:[{code:"legacy_fallback",msg:"Legacy bundle fallback used"}]};if(d>0)try{p.lastUpdated=new Date(d).toISOString()}catch{p.lastUpdated=void 0}return f.length>0&&(p.errors=f),r&&(p.pagination={page:1,pageSize:o.length,totalPages:1,hasNext:!1}),{priceMap:s,iconMap:l,rarityMap:c,itemMap:u,meta:p}}async function V({requestUrl:e,signal:t,fields:n,normalizedIds:r,iconCache:a,rarityCache:o,itemCache:i}){const s=await g(e,{signal:t,headers:{Accept:"application/json, text/plain;q=0.9"}});if(!s.ok){const e=new Error(`Error ${s.status} al consultar el agregado de bundle`);throw e.code="AGGREGATE_HTTP_ERROR",e}const l=s.headers.get("content-type")||"",c=await s.text();let u=null;if(c)try{u=JSON.parse(c)}catch(e){const t=new Error(`Datos no válidos del agregado de bundle (content-type: ${l||"desconocido"})`);throw t.code="AGGREGATE_INVALID_JSON",t.cause=e,t}if(!u||"object"!=typeof u){const e=new Error("Datos no válidos del agregado de bundle");throw e.code="AGGREGATE_INVALID_PAYLOAD",e}const f=s.headers.get("X-Snapshot-Id"),d=s.headers.get("X-Snapshot-TTL"),p=null!=d?parseInt(d,10):null,h=s.headers.get("X-Snapshot-Stale"),m=s.headers.get("X-Data-Source"),y=new Map,b=new Map,_=new Map,w=new Map;u.priceMap&&"object"==typeof u.priceMap&&Object.entries(u.priceMap).forEach(([e,t])=>{if(t&&"object"==typeof t){const n=Q(e);y.set(n,t)}}),u.iconMap&&"object"==typeof u.iconMap&&Object.entries(u.iconMap).forEach(([e,t])=>{const n=Q(e);b.set(n,t??null),a&&"object"==typeof a&&(a[n]=t??null)}),u.rarityMap&&"object"==typeof u.rarityMap&&Object.entries(u.rarityMap).forEach(([e,t])=>{const n=Q(e);_.set(n,t??null),o&&"object"==typeof o&&(o[n]=t??null)}),u.itemMap&&"object"==typeof u.itemMap&&Object.entries(u.itemMap).forEach(([e,t])=>{const n=Q(e);t&&"object"==typeof t?(w.set(n,{...t,id:Q(t.id??n)}),i&&"object"==typeof i&&(i[n]={...t})):(w.set(n,null),i&&"object"==typeof i&&(i[n]=null))});const S=r,E=Array.isArray(u.errors)?u.errors.length>0:Boolean(u.errors),A=function(e){const t=J(e);if(!t)return null;const n=new Set;return t.split(",").forEach(e=>{e&&n.add(e)}),n}(n),v=!A||A.has("priceMap"),M=!A||A.has("iconMap"),T=!A||A.has("rarityMap"),k=!!A&&A.has("itemMap"),N=S.filter(e=>!(!v||y.has(e))||(!(!M||b.has(e))||(!(!T||_.has(e))||!(!k||w.has(e)))));if(E||N.length>0){const e=new Error("Datos incompletos del agregado de bundle");throw e.code="AGGREGATE_INCOMPLETE",e.missingIds=N,e}const I={...u.meta||{}};f&&!I.snapshotId&&(I.snapshotId=f),Number.isFinite(p)&&(I.snapshotTtl=p),"string"==typeof h&&(I.stale="1"===h||!0===I.stale),m&&!I.source&&(I.source=m);let C="hit";return"fallback"===I.source?C="miss":(I.stale||Number.isFinite(p)&&p<=0)&&(C="stale"),z(C),{priceMap:y,iconMap:b,rarityMap:_,itemMap:w,meta:I}}async function K(e=[],n={}){if(!Array.isArray(e)||0===e.length)return{priceMap:new Map,iconMap:new Map,rarityMap:new Map,itemMap:new Map,meta:null};const{iconCache:r,rarityCache:a,itemCache:o,fields:i,page:s,pageSize:l,signal:c}=n||{},u=t(),f=u?.API_BASE_URL||"/api",d=n.lang||u?.DEFAULT_LANG||"es",p=new URLSearchParams,g=e.map(e=>Q(e)).filter(e=>{if(null==e||""===e)return!1;if(Number.isFinite(e))return e>0;const t=String(e).trim();return Boolean(t)});g.forEach(e=>{p.append("ids[]",String(e))}),g.length>0&&p.set("ids",g.join(",")),p.set("lang",String(d));const h=J(i);h&&p.set("fields",h),null!=s&&p.set("page",String(s)),null!=l&&p.set("pageSize",String(l));const m=`${function(e,t){const n=("string"==typeof e?e.trim():"").replace(/\/+$/,""),r=String(t).replace(/^\/+/,"");return n?r?`${n}/${r}`:n||"/":`/${r}`}(f,"/aggregate/bundle")}?${p.toString()}`;try{return await V({requestUrl:m,signal:c,fields:i,normalizedIds:g,iconCache:r,rarityCache:a,itemCache:o})}catch(e){if("AGGREGATE_INCOMPLETE"===e?.code)throw e;"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn("[aggregateBundle] API fallback for aggregate bundle",e);const t=await X(g,{lang:d}),n=function(e){const t=new Map,n=new Map,r=new Map,a=new Map;return Object.entries(e.priceMap||{}).forEach(([e,n])=>{const r=Q(e);t.set(r,n)}),Object.entries(e.iconMap||{}).forEach(([e,t])=>{const r=Q(e);n.set(r,t??null)}),Object.entries(e.rarityMap||{}).forEach(([e,t])=>{const n=Q(e);r.set(n,t??null)}),Object.entries(e.itemMap||{}).forEach(([e,t])=>{const n=Q(e);t&&"object"==typeof t?a.set(n,t):a.set(n,null)}),{priceMap:t,iconMap:n,rarityMap:r,itemMap:a}}(t);return z("miss"),{...n,meta:t.meta}}}const Y=new Set(["1","true","yes","on"]),Z=new Set(["0","false","no","off"]);function ee(e,t=!1){if("boolean"==typeof e)return e;if(null==e)return t;const n=String(e).trim().toLowerCase();return!!Y.has(n)||!Z.has(n)&&t}function te(e){if(!e)return null;switch(String(e).trim().toLowerCase().replace(/[\-_]/g,"")){case"useprecomputed":case"featureuseprecomputed":case"precomputed":case"precomputedon":return"usePrecomputed";case"donesaggregate":case"featuredonesaggregate":case"donesagg":case"donesaggregated":return"donesAggregate";default:return null}}let ne=null,re=null,ae=null;function oe(){if(null===re){const{FEATURE_USE_PRECOMPUTED:e}=t();re=ee(e,!1)}return re}function ie(){if(null===ae){const{FEATURE_DONES_AGGREGATE:e}=t();ae=ee(e,!1)}return ae}function se(){if(ne)return ne;const e={usePrecomputed:oe(),donesAggregate:ie()};let t={};if("undefined"!=typeof window)try{const e=new URLSearchParams(window.location.search||"");t=function(e){if(!e)return{};const t={},n=Array.isArray(e)?e:String(e).split(",");for(const e of n){if(!e)continue;let n=e,r="true";if("string"==typeof e){const t=e.trim();if(!t)continue;if(t.includes(":")){const[e,a]=t.split(":",2).map(e=>e.trim());n=e,r=a}else if(t.includes("=")){const[e,a]=t.split("=",2).map(e=>e.trim());n=e,r=a}else n=t,r="true"}const a=te(n);a&&(t[a]=ee(r,!0))}return t}(e.get("ff"))}catch(e){}return ne={...e,...t},ne}function le(e){if(!e)return!1;const t=se();return Boolean(t[e])}const ce=new Map;function ue(){try{if("undefined"!=typeof window&&window.sessionStorage)return window.sessionStorage;if("undefined"!=typeof sessionStorage)return sessionStorage}catch(e){console.warn("Sesión de almacenamiento no disponible",e)}return null}function fe(e){return`aggregate:item:${e}`}function de(e){const t=function(e){const t=ue();if(t)try{return t.getItem(e)}catch(e){console.warn("No se pudo leer sessionStorage",e)}return ce.get(e)??null}(fe(e));if(!t)return null;try{const e=JSON.parse(t);return e&&"object"==typeof e?{etag:"string"==typeof e.etag&&e.etag?e.etag:null,lastModified:"string"==typeof e.lastModified&&e.lastModified?e.lastModified:null,data:e.data??null,meta:e.meta??null}:null}catch(e){return console.warn("No se pudo parsear el cache del agregado",e),null}}function pe(e,{etag:t=null,lastModified:n=null,data:r=null,meta:a=null}={}){const o={etag:t||null,lastModified:n||null,data:r??null,meta:a??null};!function(e,t){const n=ue();if(n)try{null===t?n.removeItem(e):n.setItem(e,t)}catch(e){console.warn("No se pudo escribir en sessionStorage",e)}null===t?ce.delete(e):ce.set(e,t)}(fe(e),JSON.stringify(o))}function ge(e,t){const n=String(t||"").toLowerCase();if(!e||!e.headers)return null;if("function"==typeof e.headers.get){const r=e.headers.get(t);return r||e.headers.get(n)}const r="function"==typeof e.headers.entries?Array.from(e.headers.entries()):Object.entries(e.headers);for(const[e,t]of r)if(String(e).toLowerCase()===n)return Array.isArray(t)?t[0]:t;return null}async function he(e,{signal:t}={}){if(!Number.isFinite(Number(e))||Number(e)<=0)throw new Error("ID de ítem inválido");const n=Number(e),r=de(n),a={};r?.etag&&(a["If-None-Match"]=r.etag),r?.lastModified&&(a["If-Modified-Since"]=r.lastModified);const o=await g(`/api/items/${n}/aggregate`,{signal:t,headers:a}),i=ge(o,"ETag"),s=ge(o,"Last-Modified");if(304===o.status){if(r?.data)return pe(n,{etag:i||r.etag||null,lastModified:s||r.lastModified||null,data:r.data,meta:r.meta}),{data:r.data,meta:r.meta,status:304,fromCache:!0};throw new Error("Respuesta 304 sin datos en cache")}if(!(ge(o,"content-type")||"").toLowerCase().includes("application/json"))throw new Error("Respuesta no válida del agregado");const l=await o.json().catch(()=>null),{data:c,meta:u}=y(l);return pe(n,{etag:i,lastModified:s,data:c,meta:u}),{data:c,meta:u,status:o.status,fromCache:!1}}const me=e=>null!=e&&"object"==typeof e&&!Array.isArray(e);function ye(e){const t=me(e)?e:{},n=me(t.data)?t.data:{},r=me(t.meta)?t.meta:{},a=me(n.item)?{...n.item}:null;let o=null;me(n.market)?o={...n.market}:me(n.totals)&&(o={...n.totals});const i=null!=n.tree?n.tree:null,s={...r};return s.stale="boolean"==typeof r.stale&&r.stale,s.lang="string"==typeof r.lang?r.lang:"es",{item:a,market:o,tree:i,meta:s}}function be(){return"undefined"==typeof document?null:document.getElementById("freshness-banner")}function _e(e={}){const t=be();if(!t)return;const{stale:n=!1,lastUpdated:r,generatedAt:a,warnings:o=[],errors:i=[]}=e,s=function(e){if(!e)return"";try{const t=new Date(e);return Number.isNaN(t.getTime())?"":t.toLocaleString()}catch(e){return""}}(r||a),l=["freshness-banner"];n?l.push("freshness-banner--stale"):l.push("freshness-banner--fresh"),t.className=l.join(" ");const c=n?"Datos potencialmente desactualizados":"Datos actualizados",u=s?`Última generación: ${s}`:"",f=Array.isArray(o)&&o.length?`<span class="freshness-banner__warnings">Avisos: ${o.join(", ")}</span>`:"",d=Array.isArray(i)&&i.length?`<span class="freshness-banner__errors">Errores: ${i.join(", ")}</span>`:"";t.innerHTML=`\n    <strong>${c}</strong>\n    ${u?`<span class="freshness-banner__timestamp">${u}</span>`:""}\n    ${f}\n    ${d}\n  `,t.classList.remove("hidden")}function we(){const e=be();e&&(e.classList.add("hidden"),e.innerHTML="")}const Se="undefined"!=typeof window?window:"undefined"!=typeof self?self:globalThis;function Ee(e){Array.isArray(e)&&ve(e,null),Se.ingredientObjs=e}"undefined"!=typeof window&&(Se.ingredientObjs=Se.ingredientObjs||[],Se.globalQty=Se.globalQty||1,Se._mainBuyPrice=Se._mainBuyPrice||0,Se._mainSellPrice=Se._mainSellPrice||0,Se._mainRecipeOutputCount=Se._mainRecipeOutputCount||1);class Ae{constructor({id:e,name:t,icon:n,rarity:r,count:a,buy_price:o,sell_price:i,is_craftable:s,recipe:l,children:c=[],_parentId:u=null}){this._uid=Ae.nextUid++,this.id=e,this.name=t,this.icon=n,this.rarity=r,this.count=a,this.buy_price=o,this.sell_price=i,this.is_craftable=s,this.recipe=l||null,this.children=c,this.mode="buy",this.modeForParentCrafted="buy",this.expanded=!1,this._parentId=u,this._parent=null,this.countTotal=0,this.crafted_price=null,this.total_buy=0,this.total_sell=0,this.total_crafted=0}findRoot(){let e=this;for(;e._parent;)e=e._parent;return e}setMode(e){if(["buy","sell","crafted"].includes(e)){this.modeForParentCrafted=e;this.findRoot().recalc(Se.globalQty||1,null),"function"==typeof Se.safeRenderTable&&Se.safeRenderTable()}}recalc(e=1,t=null,n={}){const{skipCountTotalUpdate:r=!1}=n,a=null==t,o=19675===this.id&&(77===this.count||38===this.count);if(a?this.countTotal=this.count*e:o?this.countTotal=this.count:r||(this.countTotal=t.countTotal*this.count),this.children&&this.children.length>0)if(o){const t=77===this.count?[250,250,250,1500]:[38,38,38,38];this.children.forEach((n,r)=>{n.countTotal=t[r]||0,n.total_buy=(n.buy_price||0)*n.countTotal,n.total_sell=(n.sell_price||0)*n.countTotal,n.recalc(e,this,{skipCountTotalUpdate:!0})})}else this.children.forEach(t=>t.recalc(e,this));a?this.children&&this.children.length>0?(this.total_buy=this.children.reduce((e,t)=>e+(t.total_buy||0),0),this.total_sell=this.children.reduce((e,t)=>e+(t.total_sell||0),0)):(this.total_buy=(this.buy_price||0)*this.countTotal,this.total_sell=(this.sell_price||0)*this.countTotal):o?(this.total_buy=this.children.reduce((e,t)=>e+(t.total_buy||0),0),this.total_sell=this.children.reduce((e,t)=>e+(t.total_sell||0),0)):(this.total_buy=(this.buy_price||0)*this.countTotal,this.total_sell=(this.sell_price||0)*this.countTotal),this.is_craftable&&this.children.length>0?(this.total_crafted=this.children.reduce((e,t)=>{switch(t.modeForParentCrafted){case"buy":default:return e+(t.total_buy||0);case"sell":return e+(t.total_sell||0);case"crafted":return e+(t.total_crafted||0)}},0),this.crafted_price=this.total_crafted/(this.recipe?.output_item_count||1),a||this.buy_price||this.sell_price||(this.total_buy=this.children.reduce((e,t)=>e+(t.total_buy||0),0),this.total_sell=this.children.reduce((e,t)=>e+(t.total_sell||0),0))):(this.total_crafted=null,this.crafted_price=null)}getBestPrice(){return"number"==typeof this.buy_price&&this.buy_price>0?this.buy_price:"number"==typeof this.crafted_price&&this.crafted_price>0?this.crafted_price:0}}function ve(e,t=null){if(Array.isArray(e))for(const n of e)Object.setPrototypeOf(n,Ae.prototype),"number"==typeof n._uid&&Ae.nextUid<=n._uid&&(Ae.nextUid=n._uid+1),n._parent=t,t&&(n._parentId=t._uid),Array.isArray(n.children)&&n.children.length>0?ve(n.children,n):n.children=[]}function Me(e){Se.globalQty=e}function Te(e){return e?e.map(e=>({id:e.id,expanded:e.expanded,children:Te(e.children||[])})):[]}function ke(e,t){if(e&&t)for(let n=0;n<e.length;n++)t[n]&&(e[n].expanded=t[n].expanded,ke(e[n].children,t[n].children))}Ae.nextUid=0;let Ne={totalBuy:0,totalSell:0,totalCrafted:0};function Ie(e){const t=Number(e?.buy??e?.totalBuy??0),n=Number(e?.sell??e?.totalSell??0),r=Number(e?.crafted??e?.totalCrafted??0);Ne={totalBuy:Number.isFinite(t)?t:0,totalSell:Number.isFinite(n)?n:0,totalCrafted:Number.isFinite(r)?r:0}}function Ce(e,t){return e?st({ingredientTree:e,globalQty:t}).then(({updatedTree:t,totals:n})=>{function r(e,t){if(Object.assign(t,e),e.children&&t.children)for(let n=0;n<e.children.length;n++)r(e.children[n],t.children[n])}if(Array.isArray(t)&&ve(t,null),Array.isArray(t))for(let n=0;n<t.length;n++)r(t[n],e[n]);Ne=n||{totalBuy:0,totalSell:0,totalCrafted:0}}):Promise.resolve()}function Le(){return Ne}function Oe(e,t,n){for(const r of e){if(String(r.id)===String(t)&&String(r._parentId)===String(n))return r;if(Array.isArray(r.children)&&r.children.length){const e=Oe(r.children,t,n);if(e)return e}}return null}function Re(e,t){let n=e,r=null;for(let e=0;e<t.length;e++){const a=t[e];if(r=(n||[]).find(e=>String(e._uid)===String(a)||String(e.id)===String(a)),!r)return null;n=r.children}return r}function Ue(e,t){for(const n of e){if(String(n._uid)===String(t))return n;if(n.children&&n.children.length){const e=Ue(n.children,t);if(e)return e}}return null}function je(e,t){for(const n of e){if(String(n.id)===String(t))return n;if(n.children&&n.children.length){const e=je(n.children,t);if(e)return e}}return null}function Pe(e,t,n=[]){if(!Array.isArray(e))return n;for(const r of e)String(r.id)===String(t)&&n.push(r),r.children&&r.children.length&&Pe(r.children,t,n);return n}const $e=new Set;function Fe(e){return $e.add(e),e}function De(){$e.forEach(e=>e.abort()),$e.clear(),Be&&(Be.terminate(),Be=null)}async function xe(e){const t=Fe(new AbortController),n=`item_${e}`,r=N(n,!0),a={};r?.etag&&(a["If-None-Match"]=r.etag),r?.lastModified&&(a["If-Modified-Since"]=r.lastModified);try{try{const r=await U(`/backend/api/itemBundle.php?ids=${e}`,{headers:a,signal:t.signal});if(r.ok){const e=await r.json().catch(()=>null),{data:t,meta:a}=y(e),o=Array.isArray(t)?t[0]:null;if(o&&o.item){const e=o.item;o.nested_recipe&&(e.nested_recipe=o.nested_recipe);const t=r.headers.get("ETag"),i=r.headers.get("Last-Modified"),s=t||i?null:void 0;return e.lastUpdated=(new Date).toISOString(),k(n,e,s,{etag:t,lastModified:i}),Array.isArray(a?.errors)&&a.errors.length&&console.warn("itemBundle devolvió errores",a.errors),e}Array.isArray(a?.errors)&&a.errors.length&&console.warn("itemBundle respondió sin datos",a.errors)}}catch(e){}const o=await U(`https://api.guildwars2.com/v2/items/${e}?lang=es`,{headers:a,signal:t.signal});if(304===o.status&&r)return r.value;if(!o.ok)throw new Error(`Error ${o.status} obteniendo datos del ítem ${e}`);const i=await o.json();i.lastUpdated=(new Date).toISOString();const s=o.headers.get("ETag"),l=o.headers.get("Last-Modified");return k(n,i,s||l?null:void 0,{etag:s,lastModified:l}),i}finally{$e.delete(t)}}let Be=null;function Ge(e){if(!e||"object"!=typeof e)return null;let t;try{t="function"==typeof structuredClone?structuredClone(e):JSON.parse(JSON.stringify(e))}catch(n){t={...e}}const n=Array.isArray(t.children)?t.children:Array.isArray(t.components)?t.components:[];return t.children=n.map(e=>Ge(e)).filter(e=>null!==e),"components"in t&&delete t.components,t}async function We(e,t){if(!t||!t.ingredients||0===t.ingredients.length)return Se._mainRecipeOutputCount=t&&t.output_item_count||1,[];if(t.nested_recipe){Se._mainRecipeOutputCount=t.output_item_count||1;const e=function(e){if(!e)return[];if(Array.isArray(e))return e.map(e=>Ge(e)).filter(e=>null!==e);if("object"==typeof e){if(Array.isArray(e.tree))return e.tree.map(e=>Ge(e)).filter(e=>null!==e);if(Array.isArray(e.children))return e.children.map(e=>Ge(e)).filter(e=>null!==e);if(Array.isArray(e.components))return e.components.map(e=>Ge(e)).filter(e=>null!==e);const t=Ge(e);return t?[t]:[]}return[]}(t.nested_recipe).map(e=>qe(e,null));return ve(e,null),e.forEach(e=>e.recalc(Se.globalQty,null)),e}return Be&&Be.terminate(),Be=new Worker(new URL("./workers/ingredientTreeWorker.js",import.meta.url),{type:"module"}),new Promise((n,r)=>{const a=e=>{Be.removeEventListener("message",a),Be.removeEventListener("error",o);let t=e.data?.tree||[];Be=null,Array.isArray(t)||(t=t&&"object"==typeof t?Array.isArray(t.children)?t.children:[t]:[]);const r=t.map(e=>qe(e,null));ve(r,null),r.forEach(e=>e.recalc(Se.globalQty,null)),n(r)},o=e=>{Be.removeEventListener("message",a),Be.removeEventListener("error",o),Be=null,console.error("Error en ingredientTreeWorker:",e?.message||e,e);const t="Error procesando ingredientes"+(e?.message?`: ${e.message}`:"");Se.StorageUtils&&"function"==typeof Se.StorageUtils.showToast?Se.StorageUtils.showToast(t,"error"):"function"==typeof alert&&alert(t),r(e)};Be.addEventListener("message",a),Be.addEventListener("error",o);const i=function(){const e=Se&&"object"==typeof Se.__RUNTIME_CONFIG__?Se.__RUNTIME_CONFIG__:null;if(!e)return null;const t={};return"string"==typeof e.FETCH_GUARD_MODE&&(t.FETCH_GUARD_MODE=e.FETCH_GUARD_MODE),Array.isArray(e.FETCH_GUARD_WHITELIST)?t.FETCH_GUARD_WHITELIST=[...e.FETCH_GUARD_WHITELIST]:"string"==typeof e.FETCH_GUARD_WHITELIST&&(t.FETCH_GUARD_WHITELIST=e.FETCH_GUARD_WHITELIST.split(",").map(e=>e.trim()).filter(Boolean)),Object.prototype.hasOwnProperty.call(e,"FETCH_GUARD_REPORT_URL")&&(t.FETCH_GUARD_REPORT_URL=e.FETCH_GUARD_REPORT_URL),Array.isArray(e.CONNECT_ALLOWLIST)&&(t.CONNECT_ALLOWLIST=[...e.CONNECT_ALLOWLIST]),t}();Be.postMessage({type:"runtimeConfig",config:i}),Be.postMessage({type:"generateTree",mainItemId:e,mainRecipeData:t})})}async function He(e){const t=Fe(new AbortController),n=`recipe_${e}`,r=N(n);if(r)return $e.delete(t),r;try{const r=await U(`https://api.guildwars2.com/v2/recipes/search?output=${e}`,{signal:t.signal});if(!r.ok)return null;const a=await r.json();if(!a||0===a.length)return null;const o=a[0],i=await U(`https://api.guildwars2.com/v2/recipes/${o}?lang=es`,{signal:t.signal});if(!i.ok)throw new Error(`Error ${i.status} obteniendo datos de la receta ${o}`);const s=await i.json();return s.lastUpdated=(new Date).toISOString(),k(n,s),s}finally{$e.delete(t)}}function qe(e,t=null){const n=new Ae({id:e.id,name:e.name,icon:e.icon,rarity:e.rarity,count:e.count||1,recipe:e.recipe||null,buy_price:e.buy_price||0,sell_price:e.sell_price||0,is_craftable:e.is_craftable||!1,children:[],_parentId:t});return e.children&&e.children.length>0&&(n.children=e.children.map(e=>qe(structuredClone?structuredClone(e):JSON.parse(JSON.stringify(e)),n._uid))),n}if("undefined"!=typeof window){void 0===Se.comparativa&&(Se.comparativa={});let Zt=null;const en=new Map;function tn(e,t=null){if(!e)return null;const n=new Ae({id:e.id,name:e.name,icon:e.icon,rarity:e.rarity,count:Number.isFinite(Number(e.count))?Number(e.count):1,buy_price:Number(e.buy_price||0),sell_price:Number(e.sell_price||0),is_craftable:Boolean(e.is_craftable),recipe:e.recipe||null,children:[],_parentId:t?t._uid:null});n.countTotal=Number(e.countTotal??n.count),n.total_buy=Number(e.total_buy||0),n.total_sell=Number(e.total_sell||0),n.total_crafted=null==e.total_crafted?null:Number(e.total_crafted||0),n.crafted_price=null==e.crafted_price?null:Number(e.crafted_price||0),n.mode=e.mode||"buy",n.modeForParentCrafted=e.modeForParentCrafted||"buy",n.expanded=Boolean(e.expanded),n._parent=t||null;const r=Array.isArray(e.children)?e.children:[];return n.children=r.map(e=>tn(e,n)),n}function nn(){if(!le("usePrecomputed"))return void we();const e=Array.from(en.values()).filter(Boolean);if(!e.length)return void we();let t=null,n=!1;const r=new Set,a=new Set;e.forEach(e=>{if(!e)return;e.stale&&(n=!0),(e.warnings||[]).forEach(e=>r.add(e)),(e.errors||[]).forEach(e=>a.add(e));const o=e.lastUpdated||e.generatedAt;o&&(!t||new Date(o)>new Date(t))&&(t=o)}),_e({stale:n,lastUpdated:t,warnings:Array.from(r),errors:Array.from(a)})}function rn(e){const t=Number.isFinite(Number(e))&&Number(e)>0?Number(e):1;let n=0,r=0,a=0;return(Se.ingredientObjs||[]).forEach(e=>{const t=Number(e?.total_buy||0),o=Number(e?.total_sell||0),i=null==e?.total_crafted?t:Number(e.total_crafted||0);switch(n+=t,r+=o,e?.modeForParentCrafted){case"sell":a+=o;break;case"crafted":a+=i;break;default:a+=t}}),{totalBuy:n*t,totalSell:r*t,totalCrafted:a*t}}function an(e){null==e?en.clear():en.delete(Number(e)),nn()}async function on(e){const t=await G(e);e.forEach(e=>{const n=t.get(e)||{},r=je(Se.ingredientObjs,e);r&&(r.buy_price=n.buy_price||0,r.sell_price=n.sell_price||0,"function"==typeof r.recalc&&r.recalc(Se.globalQty||1,null))}),"function"==typeof Se.safeRenderTable&&Se.safeRenderTable()}function sn(){const e=Se.ingredientObjs?Se.ingredientObjs.map(e=>e.id):[];if(Zt&&(clearInterval(Zt),Zt=null),0===e.length)return;const t=()=>on(e);t(),Zt=setInterval(t,6e4)}Se.comparativa.getPrecomputedTotals=rn,Se.comparativa.clearComparativaMeta=an,Se.comparativa.updateFreshnessBanner=nn,Se.comparativa.agregarItemPorId=async function(e){if(Se.ingredientObjs=Se.ingredientObjs||[],Se.globalQty=Se.globalQty||1,Se.ingredientObjs.some(t=>t.id==e))return;const t=document.getElementById("item-skeleton");if(le("usePrecomputed")){Zt&&(clearInterval(Zt),Zt=null);try{"function"==typeof Se.showSkeleton&&Se.showSkeleton(t);const n=await he(e),{item:r,market:a,tree:o,meta:i}=ye(n);if(!r)return"function"==typeof Se.hideSkeleton&&Se.hideSkeleton(t),Se.showError?.("No se encontraron datos precomputados para este ítem."),en.delete(Number(e)),void nn();let s=o?tn(o,null):null;s||(s=new Ae({id:r.id,name:r.name,icon:r.icon,rarity:r.rarity,count:1,buy_price:Number(a?.unitBuyPrice||0),sell_price:Number(a?.unitSellPrice||0),is_craftable:!1,recipe:null,children:[]}),s.total_buy=Number(a?.buy||0),s.total_sell=Number(a?.sell||0),s.total_crafted=Number(a?.crafted||0)),a&&(Number.isFinite(Number(a.buy))&&(s.total_buy=Number(a.buy)),Number.isFinite(Number(a.sell))&&(s.total_sell=Number(a.sell)),Number.isFinite(Number(a.crafted))&&(s.total_crafted=Number(a.crafted))),Se._mainRecipeOutputCount=s?.recipe?.output_item_count||s?.output||1,Se._mainBuyPrice=a?.unitBuyPrice??s.buy_price??0,Se._mainSellPrice=a?.unitSellPrice??s.sell_price??0,Se.ingredientObjs.push(s),en.set(Number(s.id),i),nn(),"function"==typeof Se.safeRenderTable&&Se.safeRenderTable(Se._mainBuyPrice,Se._mainSellPrice),"function"==typeof Se.hideSkeleton&&Se.hideSkeleton(t)}catch(e){"function"==typeof Se.hideSkeleton&&Se.hideSkeleton(t),console.error("Error agregando ítem precomputado",e),Se.showError?.("No se pudo cargar el agregado del ítem.")}}else{en.clear(),we();try{"function"==typeof Se.showSkeleton&&Se.showSkeleton(t);const n=await xe(e),r=await He(e),a=await W(e),o=Array.isArray(r?.ingredients)&&r.ingredients.length>0;let i;if(Se._mainBuyPrice=a.buy_price||0,Se._mainSellPrice=a.sell_price||0,r&&o){let t=await We(e,r);Array.isArray(t)||(t=[]);const s=o&&0===t.length;if(s){const e="No se pudo construir el árbol de ingredientes. Mostrando el ítem sin receta.";Se.StorageUtils&&"function"==typeof Se.StorageUtils.showToast?Se.StorageUtils.showToast(e,"error"):console.warn(e)}Se._mainRecipeOutputCount=r.output_item_count||1,i=new Ae({id:n.id,name:n.name,icon:n.icon,rarity:n.rarity,count:1,buy_price:a.buy_price,sell_price:a.sell_price,is_craftable:!s,recipe:s?null:r,children:s?[]:t}),i.recalc(Se.globalQty||1,null)}else Se._mainRecipeOutputCount=r&&r.output_item_count||1,i=new Ae({id:n.id,name:n.name,icon:n.icon,rarity:n.rarity,count:1,buy_price:a.buy_price,sell_price:a.sell_price,is_craftable:!1,recipe:null,children:[]});Se.ingredientObjs.push(i),sn(),"function"==typeof Se.safeRenderTable&&("number"==typeof a.buy_price&&"number"==typeof a.sell_price?Se.safeRenderTable(a.buy_price,a.sell_price):Se.safeRenderTable()),"function"==typeof Se.hideSkeleton&&Se.hideSkeleton(t)}catch(e){"function"==typeof Se.hideSkeleton&&Se.hideSkeleton(t),alert("Error al agregar el ítem: "+(e?.message||e)),console.error("Error al agregar el ítem",e)}}},Se.comparativa.handleSaveComparativa=async function(){if(!Se.ingredientObjs||0===Se.ingredientObjs.length)return void Se.StorageUtils?.showToast("Agrega al menos un ítem a la comparativa","error");const e={ids:Se.ingredientObjs.map(e=>e.id),nombres:Se.ingredientObjs.map(e=>e.name),timestamp:Date.now()};Se.StorageUtils&&"function"==typeof Se.StorageUtils.saveComparativa?(await Se.StorageUtils.saveComparativa(e),Se.StorageUtils.showToast("Comparativa guardada")):alert("StorageUtils no está disponible.")},Se.comparativa.loadComparativaFromURL=function(){const e=new URLSearchParams(Se.location.search).get("ids");if(!e)return;const t=e.split(",").map(e=>parseInt(e,10)).filter(e=>!isNaN(e));if(0===t.length)return;Se.ingredientObjs=Se.ingredientObjs||[],Se.globalQty=Se.globalQty||1;const n=()=>{Se.comparativa&&"function"==typeof Se.comparativa.agregarItemPorId?(async()=>{const e=[];for(const n of t)try{await Se.comparativa.agregarItemPorId(n)}catch(t){console.error("Error cargando ítem de la URL",n,t),e.push({id:n,error:t})}if(e.length>0){const t=`No se pudieron cargar ${e.length} ítems de la URL.`;Se.StorageUtils?.showToast?Se.StorageUtils.showToast(t,"error"):alert(t)}})():setTimeout(n,50)};n()}}function ze(e,t){return!e||!t||isNaN(e)||isNaN(t)||0===t?"-":(e/t*100).toFixed(1)+"%"}function Qe(e){return Array.isArray(e)?e.map(e=>Je(e,null)):[]}function Je(e,t){const n=new Ae(e);return Object.assign(n,e),"number"==typeof e._uid&&(n._uid=e._uid,Ae.nextUid<=e._uid&&(Ae.nextUid=e._uid+1)),n._parent=t||null,n.children=Array.isArray(e.children)?e.children.map(e=>Je(e,n)):[],n}function Xe(e,t){e&&e.forEach(e=>{e.recalc(t,null)})}function Ve(e){let t=0,n=0,r=0;for(const a of e||[])switch(t+=a.total_buy||0,n+=a.total_sell||0,a.modeForParentCrafted){case"sell":r+=a.total_sell||0;break;case"crafted":r+=a.total_crafted||0;break;default:r+=a.total_buy||0}return{totalBuy:t,totalSell:n,totalCrafted:r}}function Ke({ingredientTree:e=[],globalQty:t=1}={}){const n=Qe(e);Xe(n,t);return{updatedTree:n,totals:Ve(n)}}"undefined"!=typeof window&&(Se.setIngredientObjs=Ee,Se.setGlobalQty=Me,Se.snapshotExpandState=Te,Se.restoreExpandState=ke,Se.recalcAll=Ce,Se.getTotals=Le,Se.findIngredientByIdAndParent=Oe,Se.findIngredientByPath=Re,Se.findIngredientByUid=Ue,Se.findIngredientById=je,Se.findIngredientsById=Pe,Se.calcPercent=ze);const Ye=[];let Ze=null,et=null,tt=!1;const nt=(()=>{try{const e=new URL(".",import.meta.url);return new URL("workers/costsWorker.js",e)}catch(e){return new URL("./costsWorker.js",import.meta.url)}})();function rt(e){if(e instanceof Error)return e;if(e&&"object"==typeof e){if(e.error instanceof Error)return e.error;if("string"==typeof e.message)return new Error(e.message);if("string"==typeof e.type&&""!==e.type)return new Error(`Worker error: ${e.type}`)}return new Error(String(e??"Worker error"))}function at(e,t,n){try{t(n)}finally{Ze=null,it()}}function ot(e,t){const n=t?rt(t):null;et&&(et.terminate(),et=null),tt=!0;try{const t=Ke(e.payload||{});n&&console.warn("costsWorker no disponible, usando cálculo local",n),at(0,e.resolve,t)}catch(t){if(n){const r=new Error(`${n.message}; fallback error: ${t?.message||t}`);r.cause={worker:n,fallback:t},at(0,e.reject,r)}else at(0,e.reject,rt(t))}}function it(){if(Ze||0===Ye.length)return;const e=Ye.shift();if(tt)return void ot(e);let t=null;try{t=function(){if(et)return et;if("undefined"==typeof Worker)throw new Error("Web Workers no soportados en este entorno");return et=new Worker(nt,{type:"module"}),et}()}catch(t){return void ot(e,t)}const n=()=>{t&&(t.removeEventListener("message",r),t.removeEventListener("error",a))},r=t=>{n(),at(0,e.resolve,t?.data??null)},a=t=>{n(),ot(e,t)};t.addEventListener("message",r),t.addEventListener("error",a),Ze={reject:e.reject};try{t.postMessage(e.payload)}catch(t){n(),ot(e,t)}}function st({ingredientTree:e,globalQty:t}){return n={ingredientTree:e,globalQty:t},new Promise((e,t)=>{Ye.push({payload:n,resolve:e,reject:t}),it()});var n}const lt="item.html",ct=[],ut=new Map;let ft=null;function dt(){return"undefined"!=typeof Date&&"function"==typeof Date.now?Date.now():0}function pt(){ft||(ft=setTimeout(()=>{_t({force:!0})},5e3))}function gt(e,t){if(!e.length)return 0;const n=Math.ceil(e.length*t)-1;return e[Math.min(e.length-1,Math.max(0,n))]}function ht(){for(const e of ut.values())if(e.samples.length>0)return!0;return!1}function mt(){const e=function(){const e="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:null;return e?(Array.isArray(e.__GW2_TELEMETRY__)||(e.__GW2_TELEMETRY__=[]),e.__GW2_TELEMETRY__):null}();if(e)for(;ct.length;)e.push(ct.shift());else(ct.length||ht())&&pt()}function yt(e={}){const t={view:e.view||lt,bucket:e.bucket??null,type:e.type||"custom",timestamp:e.timestamp||(new Date).toISOString()};return null!=e.meta&&(t.meta=e.meta),null!=e.metrics&&(t.metrics=e.metrics),null!=e.tags&&(t.tags=e.tags),null!=e.error&&(t.error=e.error),function(e){ct.push(e),ct.length>=10?_t():pt()}(t),t}function bt({bucket:e=null,stale:t=null,duration:n}){if(!Number.isFinite(n)||n<0)return;const r=Number.isFinite(e)?Number(e):e,a=null==t?null:Boolean(t),o=`${r??"unknown"}|${null===a?"u":a?"1":"0"}`;let i=ut.get(o);i||(i={bucket:r??null,stale:a,samples:[],lastUpdated:dt()},ut.set(o,i)),i.samples.push(n),i.lastUpdated=dt(),i.samples.length>=10?_t():pt()}function _t({force:e=!1}={}){ft&&(clearTimeout(ft),ft=null),function({force:e=!1}={}){const t=dt(),n=[];for(const r of ut.values()){if(!r.samples.length)continue;if(!(e||r.samples.length>=10||t-r.lastUpdated>=5e3))continue;const a=[...r.samples].sort((e,t)=>e-t),o={view:lt,bucket:r.bucket,type:"aggregatePerformance",timestamp:(new Date).toISOString(),metrics:{count:a.length,p95:gt(a,.95),p99:gt(a,.99)},meta:{stale:r.stale}};n.push(o),r.samples=[],r.lastUpdated=t}n.length&&ct.push(...n)}({force:e}),mt(),e||!ct.length&&!ht()||pt()}function wt(){return"undefined"!=typeof performance&&"function"==typeof performance.now?performance.now():dt()}function St(e=[],t,n=6e4){if(!Array.isArray(e)||0===e.length)return()=>{};let r=!1;return async function a(){if(r)return;const o=p.getBackoff();o&&await new Promise(e=>setTimeout(e,o));try{const n=await G(e);"function"==typeof t&&t(n)}catch(e){p.recordFailure()}r||setTimeout(a,n)}(),()=>{r=!0}}const Et="gw2.precomputed.bucket";function At(){const e="undefined"!=typeof window&&window&&window.localStorage?window.localStorage:"undefined"!=typeof globalThis&&globalThis.localStorage?globalThis.localStorage:null,t=function(e){if(null==e)return null;const t=Number.parseInt(e,10);return Number.isNaN(t)||t<0||t>=100?null:t}(function(e){if(!e)return null;try{return e.getItem(Et)}catch{return null}}(e));if(null!==t)return t;const n=Math.floor(100*Math.random());return function(e,t){if(e)try{e.setItem(Et,String(t))}catch{}}(e,n),n}function vt(e,t=0){if(null==e)return t;const n=Number(e);return Number.isFinite(n)?n:t}function Mt(e){return e?Tt(e,null):null}function Tt(e,t){const n=new Ae({id:e.id,name:e.name,icon:e.icon,rarity:e.rarity,count:vt(e.count,1),buy_price:vt(e.buy_price,0),sell_price:vt(e.sell_price,0),is_craftable:Boolean(e.is_craftable),recipe:e.recipe||null,children:[],_parentId:t?t._uid:null});n.countTotal=vt(e.countTotal,n.count),n.total_buy=vt(e.total_buy,n.buy_price*n.countTotal),n.total_sell=vt(e.total_sell,n.sell_price*n.countTotal),n.total_crafted=null==e.total_crafted?null:vt(e.total_crafted,0),n.crafted_price=null==e.crafted_price?null:vt(e.crafted_price,0),n.mode=e.mode||"buy",n.modeForParentCrafted=e.modeForParentCrafted||"buy",n.expanded=Boolean(e.expanded),n._parent=t||null;const r=Array.isArray(e.children)?e.children:[];return n.children=r.map(e=>Tt(e,n)),n}const kt=new Map,Nt=new WeakMap,It=new Map,Ct="undefined"!=typeof IntersectionObserver?new IntersectionObserver(e=>{e.forEach(e=>{const t=e.target;if(Nt.set(t,e.isIntersecting),e.isIntersecting){const e=t.dataset.stateId||t.dataset.path;if(!e)return;const n=kt.get(e);if(!n)return;const r=n.find(e=>e.el===t),a=t._pendingState;r&&a&&(r.renderFn(a),t._pendingState=null)}})}):null;function Lt(e,t,n){const r=String(e);t.dataset.stateId=r;let a=kt.get(r);a||(a=[],kt.set(r,a)),a.push({el:t,renderFn:n}),Ct?Ct.observe(t):(Nt.set(t,!0),n&&It.has(r)&&(n(It.get(r)),t._pendingState=null))}function Ot(e,t){const n=String(e);It.set(n,t);const r=kt.get(n);r&&r.forEach(({el:e,renderFn:n})=>{Ct?Nt.get(e)?n&&n(t):e._pendingState=t:n&&(n(t),e._pendingState=null)})}var Rt=Object.freeze({__proto__:null,register:Lt,update:Ot});function Ut(){const e=document.querySelectorAll("img[data-src]");if("undefined"==typeof IntersectionObserver)return void e.forEach(e=>{e.dataset&&e.dataset.src&&(e.src=e.dataset.src)});const t=new IntersectionObserver(e=>{e.forEach(e=>{if(e.isIntersecting){const n=e.target;n.src=n.dataset.src,t.unobserve(n)}})});e.forEach(e=>t.observe(e))}function jt(e,t){if(!e)return;if("undefined"==typeof IntersectionObserver)return void("function"==typeof t&&t());const n=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(t(),n.unobserve(e.target))})});n.observe(e)}const Pt=new Set,$t=new Map;let Ft=null,Dt=null;function xt(e){const t=Number(e);return Number.isNaN(t)?e:t}function Bt(e){if(!e)return{item:e,meta:null};if(e.data&&e.data.item){const t={...e.data.item},n=e.meta||{};["lang","source","fallback"].forEach(e=>{void 0!==n[e]&&void 0===t[e]&&(t[e]=n[e])});const r={};return void 0!==n.lang&&(r.lang=n.lang),void 0!==n.source&&(r.source=n.source),void 0!==n.fallback&&(r.fallback=n.fallback),{item:t,meta:Object.keys(r).length?r:null}}if(e.meta&&"object"==typeof e.meta){const t={};return void 0!==e.meta.lang&&(t.lang=e.meta.lang),void 0!==e.meta.source&&(t.source=e.meta.source),void 0!==e.meta.fallback&&(t.fallback=e.meta.fallback),{item:e,meta:Object.keys(t).length?t:null}}return{item:e,meta:null}}function Gt(){Ft||(Ft=setTimeout(Ht,50)),Pt.size>=200&&(clearTimeout(Ft),Ht())}async function Wt(e,t,{baseUrl:n,signal:r,backoff:a,allowConditional:o}){if(!e.length)return{status:200,items:new Map,missing:[],metaById:new Map};const i=t?`&lang=${t}`:"",s=o?function(e,t){if(1!==e.length)return{};const n=N(`item_${e[0]}`,!0);if(!n)return{};if(n.lang&&t&&n.lang!==t)return{};const r={};return n.etag&&(r["If-None-Match"]=n.etag),n.lastModified&&(r["If-Modified-Since"]=n.lastModified),r}(e,t):{},l=await g(`${n}${e.join(",")}${i}`,{headers:s,signal:r,backoff:a});if(304===l.status)return{status:304};if(!l.ok)throw new Error(`Unexpected response status: ${l.status}`);const c=await l.json();if(!Array.isArray(c))throw new Error("Unexpected response format");const u=l.headers.get("ETag"),f=l.headers.get("Last-Modified"),d=new Map,p=new Map;c.forEach(e=>{const{item:n,meta:r}=Bt(e);if(!n||void 0===n.id)return;const a=xt(n.id);d.set(a,n);const o={etag:u,lastModified:f,lang:t};r&&(void 0!==r.lang&&(o.lang=r.lang),void 0!==r.source&&(o.source=r.source),void 0!==r.fallback&&(o.fallback=r.fallback)),p.set(a,o)});const h=e.filter(e=>!d.has(e));return{status:l.status,items:d,missing:h,metaById:p}}async function Ht(){if(0===Pt.size)return void(Ft=null);Ft=null;const e=Array.from(Pt).slice(0,200);e.forEach(e=>Pt.delete(e));try{const n=p.getBackoff();n&&await new Promise(e=>setTimeout(e,n)),Dt=new AbortController;const{API_BASE_URL:r,LANG:a,DEFAULT_LANG:o,FALLBACK_LANGS:i=[]}=t(),s=(a||o||"").trim()||"es",l=Array.isArray(i)?[...new Set(i.filter(e=>e&&e!==s))]:[],c=`${r}/items?ids=`,u=300+n;let f=null;try{if(f=await Wt(e,s,{baseUrl:c,signal:Dt.signal,backoff:u,allowConditional:!0}),304===f.status)return void e.forEach(e=>{const t=$t.get(e),n=N(`item_${e}`);t&&t.resolve(n),$t.delete(e)})}catch(e){if(e instanceof DOMException&&"AbortError"===e.name)throw e;f=null}const d=new Map,h=new Map;let m=[...e];f&&f.items&&(f.items.forEach((e,t)=>{const n=xt(t);d.set(n,e);const r=f.metaById?.get(t);r&&h.set(n,r)}),m=f.missing);for(const e of l){if(!m.length)break;let t=null;try{if(t=await Wt(m,e,{baseUrl:c,signal:Dt.signal,backoff:u,allowConditional:!1}),304===t.status){const t=[];m.forEach(n=>{const r=N(`item_${n}`,!0);r&&r.value?(d.set(n,r.value),h.set(n,{etag:r.etag??null,lastModified:r.lastModified??null,lang:r.lang??e})):t.push(n)}),m=t;continue}}catch(e){if(e instanceof DOMException&&"AbortError"===e.name)throw e;continue}t&&t.items&&(t.items.forEach((n,r)=>{const a=xt(r);d.set(a,n);const o=t.metaById?.get(r);o?h.set(a,o):h.set(a,{lang:e})}),m=t.missing)}if(m.length){const e=[];await Promise.all(m.map(async t=>{const n=xt(t);try{const a=`${r}/items/${t}?lang=${s}`,o=await g(a,{signal:Dt.signal,backoff:u});if(304===o.status){const t=N(`item_${n}`,!0);return t&&t.value?(d.set(n,t.value),void h.set(n,{etag:t.etag??null,lastModified:t.lastModified??null,lang:t.lang??s,source:t.source??null,fallback:t.fallback??null})):void e.push(n)}if(404===o.status)return void e.push(n);if(!o.ok)return console.warn(`[requestManager] failed to fetch item ${t}: unexpected status ${o.status}`),void e.push(n);const i=async e=>{console.warn(`[requestManager] official API fallback for item ${t}: ${e}`);try{const e=`https://api.guildwars2.com/v2/items/${t}?lang=${s}`,n=await g(e,{signal:Dt.signal,backoff:u});if(!n.ok)return console.warn(`[requestManager] official API fallback failed for item ${t}: unexpected status ${n.status}`),!1;const r=n.headers.get("content-type");if(!r||!String(r).toLowerCase().includes("application/json"))return console.warn(`[requestManager] official API fallback failed for item ${t}: unexpected content-type ${r||"unknown"}`),!1;let a;try{a=await n.json()}catch(e){if(e instanceof SyntaxError)return console.warn(`[requestManager] official API fallback failed for item ${t}: invalid JSON response`,e),!1;throw e}const{item:o,meta:i}=Bt(a);if(!o||void 0===o.id)return console.warn(`[requestManager] official API fallback failed for item ${t}: missing item id`),!1;const l=xt(o.id),c={etag:n.headers.get("ETag"),lastModified:n.headers.get("Last-Modified"),lang:o.lang||i?.lang||s,source:i?.source||"official-api",fallback:i?.fallback||"official-api"};return o.source&&(c.source=o.source),o.fallback&&(c.fallback=o.fallback),d.set(l,o),h.set(l,c),k(`item_${l}`,o,void 0,c),!0}catch(e){if(e instanceof DOMException&&"AbortError"===e.name)throw e;return console.warn(`[requestManager] official API fallback failed for item ${t}: ${e&&e.message?e.message:e}`),!1}},l=o.headers.get("content-type");if(!l||!String(l).toLowerCase().includes("application/json")){return void(await i(`unexpected content-type ${l||"unknown"}`)||e.push(n))}let c;try{c=await o.json()}catch(t){if(t instanceof SyntaxError){return void(await i("invalid JSON response")||e.push(n))}throw t}const{item:f,meta:p}=Bt(c);if(!f||void 0===f.id)return void e.push(n);const m=xt(f.id),y={etag:o.headers.get("ETag"),lastModified:o.headers.get("Last-Modified"),lang:f.lang||s};p&&(void 0!==p.lang&&(y.lang=p.lang),void 0!==p.source&&(y.source=p.source),void 0!==p.fallback&&(y.fallback=p.fallback)),f.source&&(y.source=f.source),f.fallback&&(y.fallback=f.fallback),d.set(m,f),h.set(m,y),k(`item_${m}`,f,void 0,y)}catch(r){if(r instanceof DOMException&&"AbortError"===r.name)throw r;console.warn(`[requestManager] failed to fetch item ${t}: ${r&&r.message?r.message:r}`),e.push(n)}})),m=e}e.forEach(e=>{const t=xt(e),n=$t.get(t)||$t.get(e);if(!n)return;const r=d.get(t);if(r){const e={...h.get(t)||{lang:s}};r&&r.lang&&(e.lang=r.lang),r&&r.source&&(e.source=r.source),r&&r.fallback&&(e.fallback=r.fallback),h.set(t,e),k(`item_${t}`,r,void 0,e),n.resolve(r)}else n.resolve(null);$t.delete(t),t!==e&&$t.delete(e)})}catch(t){e.forEach(e=>{const n=$t.get(e);n&&(t instanceof DOMException&&t.name,n.reject(t),$t.delete(e))})}Pt.size>0&&Gt()}function qt(e=[],t){Dt&&(Dt.abort(),Dt=null),t&&t.addEventListener("abort",()=>Dt&&Dt.abort(),{once:!0});const n=e.map(e=>{const t=xt(e),n=N(`item_${t}`);if(n)return Promise.resolve(n);if($t.has(t))return $t.get(t).promise;const r={};return r.promise=new Promise((e,t)=>{r.resolve=e,r.reject=t}),$t.set(t,r),Pt.add(t),Gt(),r.promise});return Promise.all(n)}!function(){if("undefined"!=typeof localStorage)for(let e=0;e<localStorage.length;e++){const t=localStorage.key(e);t.startsWith("item_")&&N(t)}}();const zt="img/item-placeholder.svg";function Qt(){return zt}"undefined"!=typeof module&&module.exports&&(module.exports.ITEM_ICON_PLACEHOLDER_PATH=zt,module.exports.getItemIconPlaceholderPath=Qt,module.exports.default=zt);export{b as $,Mt as A,bt as B,St as C,he as D,Lt as E,Ot as F,Ut as G,jt as H,qt as I,Qt as J,Ke as K,Qe as L,Xe as M,Ve as N,Ee as O,Ae as P,Ie as Q,Oe as R,Re as S,je as T,Pe as U,De as V,xe as W,We as X,He as Y,qe as Z,ze as _,N as a,P as a0,q as a1,Rt as a2,g as b,K as c,I as d,H as e,U as f,W as g,X as h,le as i,ve as j,Ue as k,Me as l,Ce as m,y as n,Te as o,G as p,ke as q,st as r,k as s,yt as t,Le as u,At as v,we as w,wt as x,_e as y,ye as z};
