const e={19676:1e4};let t=new Map,n=new Map,r=new Map;async function i(o,s=null){const c=function(e){const t=Number(e);return Number.isFinite(t)&&n.get(t)||null}(o.id),l=c?.name||o.name,u=c?.type||o.type,a=function(e,n,r){const i=Number(e);return!Number.isFinite(i)||(!!t.has(i)||((e=>{if("string"!=typeof e||!e)return!1;const t=e.toLowerCase();return((e="")=>{if(!e)return!1;const t=e.toLowerCase();return t.startsWith("don de ")||t.startsWith("don del ")||t.startsWith("don de la ")})(e)||t.includes("tributo")||t.includes("bendiciÃ³n")})(n)?(t.set(i,"gift"),!0):!!("string"==typeof r?r.toLowerCase():"").includes("account")&&(t.set(i,"account"),!0)))}(o.id,l,u)?null:function(t){const n=Number(t);if(!Number.isFinite(n))return null;if(Object.prototype.hasOwnProperty.call(e,n)){const t=e[n];return{buy_price:t,sell_price:t}}return r.get(n)||null}(o.id),p=Array.isArray(o.components)?await Promise.all(o.components.map(e=>i(e,o.id))):[];return{id:o.id,name:l,icon:c?.icon||null,rarity:c?.rarity||null,type:u||null,count:o.count,buy_price:a?.buy_price??null,sell_price:a?.sell_price??null,is_craftable:p.length>0,children:p,_parentId:s}}const o="undefined"!=typeof self?self:globalThis;o.onmessage=async s=>{const{rootIngredients:c=[],skipEntries:l,preloadedItems:u,preloadedPrices:a,preloadContext:p}=s.data||{};Array.isArray(l)&&function(e=[]){const n=new Map;for(const t of e){if(!Array.isArray(t))continue;const[e,r]=t,i=Number(e);Number.isFinite(i)&&n.set(i,r||"market")}t=n}(l),u&&function(e={}){const t=new Map;e&&"object"==typeof e&&Object.entries(e).forEach(([e,n])=>{const r=Number(e);Number.isFinite(r)&&n&&"object"==typeof n&&t.set(r,{id:r,name:n.name||null,icon:n.icon||null,rarity:n.rarity||null,type:n.type||null})}),n=t}(u),a&&function(t={}){const n=new Map;t&&"object"==typeof t&&Object.entries(t).forEach(([e,t])=>{const r=Number(e);if(!Number.isFinite(r)||!t||"object"!=typeof t)return;const i=null!=t.buy_price?t.buy_price:null,o=null!=t.sell_price?t.sell_price:null;n.set(r,{buy_price:i,sell_price:o})}),Object.entries(e).forEach(([e,t])=>{const r=Number(e);Number.isFinite(r)&&n.set(r,{buy_price:t,sell_price:t})}),r=n}(a),p&&(o.__donesLastPreloadContext__=p);const b=await Promise.all(c.map(e=>i(e,null)));o.postMessage({ingredientTree:b})};export{i as adaptNode};
