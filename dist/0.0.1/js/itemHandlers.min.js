function t(){const t=document.getElementById("btn-guardar-item");t&&t.addEventListener("click",o)}function e(){const t=["#item-header .item-link","#item-header .item-name","#item-header [data-item-name]","#item-header h1","#item-header h2",".ingred-row[data-path] .item-link"];for(const e of t){const t=document.querySelector(e),n=t?.textContent?.trim();if(n)return n}return null}async function n(){const t=e();if(t)return t;const n=window.ingredientObjs?.[0]?.name?.trim();if(n)return n;const o=await function(t=1500){const n=e();if(n)return Promise.resolve(n);const o=document.getElementById("item-header");return o?new Promise(n=>{const i=new MutationObserver(()=>{const t=e();t&&(i.disconnect(),n(t))});i.observe(o,{childList:!0,subtree:!0,characterData:!0}),setTimeout(()=>{i.disconnect(),n(e())},t)}):Promise.resolve(null)}();if(o)return o;const i=window.ingredientObjs?.[0]?.name?.trim();return i||"Ítem sin nombre"}async function o(){if(!(window.Auth&&window.Auth.currentUser))return void(window.showAuthOptions?window.showAuthOptions():window.Auth&&window.Auth.requireAuth&&window.Auth.requireAuth());const t=new URLSearchParams(window.location.search).get("id"),e=await n();if(!t)return void window.StorageUtils?.showToast("No se pudo obtener el ítem actual","error");const o={id:parseInt(t,10),nombre:e};window.StorageUtils&&window.StorageUtils.saveFavorito&&await window.StorageUtils.saveFavorito(o),window.StorageUtils?.showToast("Ítem guardado en favoritos")}document.addEventListener("DOMContentLoaded",function(){t()}),"complete"!==document.readyState&&"interactive"!==document.readyState||setTimeout(t,1);
